<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>blackhat.tests.test_binaries API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>blackhat.tests.test_binaries</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">import datetime
import unittest
from base64 import b32decode, b64decode
from hashlib import md5, sha1, sha256, sha512, sha384, sha224
from time import sleep

from .setup_computers_universal import init
from ..helpers import Result, ResultMessages
from ..session import Session
from ..user import User


class TestIncludedBinaries(unittest.TestCase):
    &#34;&#34;&#34;
    These test cases test the functionality of the binaries that are included with the system
    This is anything in the client/blackhat/bin folder (not including files in the installable folder)
    &#34;&#34;&#34;

    def setUp(self) -&gt; None:
        self.computer = init()

    def test_add_user(self):
        self.computer.run_command(&#34;adduser&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;adduser&#34;, [&#34;--help&#34;], True)

        fail_bc_not_root_result = self.computer.run_command(&#34;adduser&#34;, [&#34;testuser&#34;, &#34;-p&#34; &#34;password&#34;, &#34;-n&#34;], True)
        expected_fail_bc_not_root_result = Result(success=False, message=ResultMessages.NOT_ALLOWED,
                                                  data=&#34;adduser: Only root can add new users!\n&#34;)

        self.assertEqual(fail_bc_not_root_result, expected_fail_bc_not_root_result)

        self.computer.sessions.append(Session(0, self.computer.fs.files, self.computer.sessions[-1].id + 1))

        create_new_user_result = self.computer.run_command(&#34;adduser&#34;, [&#34;testuser&#34;, &#34;-p&#34; &#34;password&#34;, &#34;-n&#34;], True)
        expected_create_new_user_result = Result(success=True, message=None, data=None)
        create_duplicate_user_result = self.computer.run_command(&#34;adduser&#34;, [&#34;testuser&#34;, &#34;-p&#34; &#34;password&#34;, &#34;-n&#34;], True)
        expected_create_duplicate_user_result = Result(success=False, message=ResultMessages.ALREADY_EXISTS,
                                                       data=&#34;adduser: The user &#39;testuser&#39; already exists.\n&#34;)

        self.assertEqual(create_new_user_result, expected_create_new_user_result)
        self.assertEqual(create_duplicate_user_result, expected_create_duplicate_user_result)

        # Now confirm that the user was actually added
        get_user_result = self.computer.get_user(username=&#34;testuser&#34;)
        expected_get_user_result = Result(success=True, message=None,
                                          data=User(1001, &#34;testuser&#34;, md5(&#34;password&#34;.encode()).hexdigest()))
        self.assertEqual(get_user_result, expected_get_user_result)

    def test_base32(self):
        self.computer.run_command(&#34;base32&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;base32&#34;, [&#34;--help&#34;], True)

        message = &#34;Hello!&#34;

        self.computer.run_command(&#34;touch&#34;, [&#34;file&#34;], True)
        # We&#39;re writing with a new line to replicate what `echo hello! &gt; file` would do
        self.computer.fs.find(&#34;/home/steve/file&#34;).data.write(message + &#34;\n&#34;, self.computer)

        base32_result = self.computer.run_command(&#34;base32&#34;, [&#34;file&#34;], True).data.replace(&#34;\n&#34;, &#34;&#34;).split(&#34; &#34;)[1]
        self.assertEqual(b32decode(base32_result).decode().strip(&#34;\n&#34;), message)

    def test_base64(self):
        self.computer.run_command(&#34;base64&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;base64&#34;, [&#34;--help&#34;], True)

        message = &#34;Hello!&#34;

        self.computer.run_command(&#34;touch&#34;, [&#34;file&#34;], True)
        # We&#39;re writing with a new line to replicate what `echo hello! &gt; file` would do
        self.computer.fs.find(&#34;/home/steve/file&#34;).data.write(message + &#34;\n&#34;, self.computer)

        base64_result = self.computer.run_command(&#34;base64&#34;, [&#34;file&#34;], True).data.replace(&#34;\n&#34;, &#34;&#34;).split(&#34; &#34;)[1]
        self.assertEqual(b64decode(base64_result).decode().strip(&#34;\n&#34;), message)

    def test_cd(self):
        self.computer.run_command(&#34;cd&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;cd&#34;, [&#34;--help&#34;], True)

        self.assertEqual(self.computer.sys_getcwd().pwd(), &#34;/home/steve&#34;)
        self.computer.run_command(&#34;cd&#34;, [&#34;..&#34;], True)
        self.assertEqual(self.computer.sys_getcwd().pwd(), &#34;/home&#34;)
        self.computer.run_command(&#34;cd&#34;, [&#34;...&#34;], True)
        self.assertEqual(self.computer.sys_getcwd().pwd(), &#34;/&#34;)
        self.computer.run_command(&#34;cd&#34;, [&#34;/etc/skel/Desktop&#34;], True)
        self.assertEqual(self.computer.sys_getcwd().pwd(), &#34;/etc/skel/Desktop&#34;)
        self.computer.run_command(&#34;cd&#34;, [&#34;~&#34;], True)
        self.assertEqual(self.computer.sys_getcwd().pwd(), &#34;/home/steve&#34;)

    def test_chown(self):
        self.computer.run_command(&#34;chown&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;chown&#34;, [&#34;--help&#34;], True)

        self.computer.run_command(&#34;touch&#34;, [&#34;testfile&#34;], True)

        self.assertEqual(self.computer.fs.find(&#34;/home/steve/testfile&#34;).data.owner, 1000)
        self.assertEqual(self.computer.fs.find(&#34;/home/steve/testfile&#34;).data.group_owner, 1000)

        self.computer.run_command(&#34;chown&#34;, [&#34;root:root&#34;, &#34;testfile&#34;], True)
        self.assertEqual(self.computer.fs.find(&#34;/home/steve/testfile&#34;).data.owner, 0)
        self.assertEqual(self.computer.fs.find(&#34;/home/steve/testfile&#34;).data.group_owner, 0)

    def test_clear(self):
        self.computer.run_command(&#34;clear&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;clear&#34;, [&#34;--help&#34;], True)

        self.computer.run_command(&#34;clear&#34;, [], True)

    def test_commands(self):
        self.computer.run_command(&#34;commands&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;commands&#34;, [&#34;--help&#34;], True)

        commands_result = self.computer.run_command(&#34;commands&#34;, [], True).data.strip(&#34;\n&#34;)
        self.assertIn(&#34;ls&#34;, commands_result)

        # Now lets remove ls from /bin (it shouldn&#39;t show up in commands)
        # We need root permissions
        self.computer.sessions.append(Session(0, self.computer.fs.files, self.computer.sessions[-1].id + 1))
        move_result = self.computer.run_command(&#34;mv&#34;, [&#34;/bin/ls&#34;, &#34;/tmp&#34;], True)
        self.assertTrue(move_result.success)

        commands_result = self.computer.run_command(&#34;commands&#34;, [], True).data.strip(&#34;\n&#34;)
        self.assertNotIn(&#34;ls&#34;, commands_result)

    def test_date(self):
        self.computer.run_command(&#34;date&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;date&#34;, [&#34;--help&#34;], True)

        date_result = self.computer.run_command(&#34;date&#34;, [], True)

        local_timezone = datetime.datetime.now(datetime.timezone.utc).astimezone().tzinfo
        time_first = datetime.datetime.now().strftime(&#39;%a %b %d %I:%M:%S %p&#39;)
        time_second = datetime.datetime.now().strftime(&#39;%Y&#39;)

        expected_result = f&#34;{time_first} {local_timezone} {time_second}&#34;

        self.assertEqual(date_result.data.strip(&#34;\n&#34;), expected_result)

    def test_echo(self):
        self.computer.run_command(&#34;echo&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;echo&#34;, [&#34;--help&#34;], True)

        echo_result = self.computer.run_command(&#34;echo&#34;, [&#34;hello!&#34;], True)
        self.assertEqual(echo_result.data, &#34;hello!\n&#34;)

        # Test -e flag
        echo_e_flag_result = self.computer.run_command(&#34;echo&#34;, [&#34;-e&#34;, &#34;hello\n\tworld!&#34;], True)
        self.assertEqual(echo_e_flag_result.data, &#34;hello\n\tworld!\n&#34;)

        # Test -n flag
        echo_n_flag_result = self.computer.run_command(&#34;echo&#34;, [&#34;-n&#34;, &#34;hello world!\n&#34;], True)
        self.assertEqual(echo_n_flag_result.data, &#34;hello world!\n&#34;)

    def test_env(self):
        self.computer.run_command(&#34;env&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;env&#34;, [&#34;--help&#34;], True)

        env_result = self.computer.run_command(&#34;env&#34;, [], True).data.strip(&#34;\n&#34;)
        print(f&#34;ENVRESULT: {env_result}&#34;)
        self.assertEqual(env_result, &#34;PATH=/usr/bin:/bin\nHOME=/home/steve\nUSER=steve&#34;)

    def test_export(self):
        self.computer.run_command(&#34;export&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;export&#34;, [&#34;--help&#34;], True)

        # Lets get a baseline for the env before-hand
        env_result = self.computer.run_command(&#34;printenv&#34;, [], True).data.strip(&#34;\n&#34;)
        self.assertEqual(env_result, &#34;PATH=/usr/bin:/bin\nHOME=/home/steve\nUSER=steve&#34;)

        self.computer.run_command(&#34;export&#34;, [&#34;BASH=/bin/bash&#34;], True)

        env_result = self.computer.run_command(&#34;printenv&#34;, [], True).data.strip(&#34;\n&#34;)
        self.assertEqual(env_result, &#34;PATH=/usr/bin:/bin\nHOME=/home/steve\nUSER=steve\nBASH=/bin/bash&#34;)

    def test_hostname(self):
        self.computer.run_command(&#34;hostname&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;hostname&#34;, [&#34;--help&#34;], True)

        # We want to try to set the hostname without root permission (should fail)
        set_hostname_result = self.computer.run_command(&#34;hostname&#34;, [&#34;localhost&#34;], True)
        expected_set_hostname_result = Result(success=False,
                                              data=&#34;hostname: you must be root to change the host name&#34;)

        set_hostname_result.data = set_hostname_result.data.strip(&#34;\n&#34;)

        self.assertEqual(set_hostname_result, expected_set_hostname_result)

        # Make sure it failed
        get_hostname_result = self.computer.run_command(&#34;hostname&#34;, [], True)

        self.assertNotEqual(get_hostname_result.data, &#34;localhost&#34;)

        # Switch to root then change hostname
        self.computer.sessions.append(Session(0, self.computer.fs.files, self.computer.sessions[-1].id + 1))

        self.computer.run_command(&#34;hostname&#34;, [&#34;localhost&#34;], True)
        get_hostname_result = self.computer.run_command(&#34;hostname&#34;, [], True)

        self.assertEqual(get_hostname_result.data.strip(&#34;\n&#34;), &#34;localhost&#34;)

    def test_id(self):
        self.computer.run_command(&#34;id&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;id&#34;, [&#34;--help&#34;], True)

        self_id_result = self.computer.run_command(&#34;id&#34;, [], True).data.strip(&#34;\n&#34;)
        expected_self_id_result = &#34;uid=1000(steve) gid=1000(steve) &#34;
        self.assertEqual(self_id_result, expected_self_id_result)

        root_id_result = self.computer.run_command(&#34;id&#34;, [&#34;root&#34;], True).data.strip(&#34;\n&#34;)
        root_id_by_uid_result = self.computer.run_command(&#34;id&#34;, [&#34;0&#34;], True).data.strip(&#34;\n&#34;)
        expected_root_result = &#34;uid=0(root) gid=0(root) &#34;
        self.assertEqual(root_id_result, expected_root_result)
        self.assertEqual(root_id_by_uid_result, expected_root_result)

        # Check the flags
        id_result = self.computer.run_command(&#34;id&#34;, [&#34;-g&#34;], True).data.strip(&#34;\n&#34;)
        self.assertEqual(id_result, &#34;1000&#34;)

        id_result = self.computer.run_command(&#34;id&#34;, [&#34;-G&#34;], True).data.strip(&#34;\n&#34;)
        self.assertEqual(id_result, &#34;1000&#34;)

        id_result = self.computer.run_command(&#34;id&#34;, [&#34;-n&#34;], True).data.strip(&#34;\n&#34;)
        self.assertEqual(id_result, &#34;steve&#34;)

    def test_ls(self):
        import re
        self.computer.run_command(&#34;ls&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;ls&#34;, [&#34;--help&#34;], True)

        # In the user&#39;s home directory, The files should be: Desktop Documents Downloads Music Pictures Public Templates Videos
        ls_result = self.computer.run_command(&#34;ls&#34;, [&#34;--no-color&#34;], True)
        expected_ls_result = Result(success=True, message=None,
                                    data=&#34;Desktop Documents Downloads Music Pictures Public Templates Videos &#34;)

        ls_result.data = ls_result.data.strip(&#34;\n&#34;)

        print(ls_result)
        print(expected_ls_result)

        color_filter = re.compile(r&#39;\x1b[^m]*m&#39;)
        stripped_color = color_filter.sub(&#39;&#39;, ls_result.data)

        self.assertEqual(stripped_color, expected_ls_result.data)
        # Make sure .shellrc isn&#39;t there (as -a isn&#39;t specified)
        self.assertNotIn(&#34;.shellrc&#34;, ls_result.data)

        # Test -a flag (show hidden files)
        ls_result = self.computer.run_command(&#34;ls&#34;, [&#34;--no-color&#34;, &#34;-a&#34;], True)
        self.assertIn(&#34;.shellrc&#34;, ls_result.data)

        # Make sure -l flag works
        ls_result = self.computer.run_command(&#34;ls&#34;, [&#34;--no-color&#34;, &#34;-l&#34;], True)
        self.assertIn(&#34;steve&#34;, ls_result.data)

    def test_md5sum(self):
        self.computer.run_command(&#34;md5sum&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;md5sum&#34;, [&#34;--help&#34;], True)

        message = &#34;hello!&#34;

        self.computer.run_command(&#34;touch&#34;, [&#34;file&#34;], True)
        # We&#39;re writing with a new line to replicate what `echo hello! &gt; file` would do
        self.computer.fs.find(&#34;/home/steve/file&#34;).data.write(message + &#34;\n&#34;, self.computer)

        self.assertIn(md5((message + &#34;\n&#34;).encode()).hexdigest(),
                      self.computer.run_command(&#34;md5sum&#34;, [&#34;file&#34;], True).data.strip(&#34;\n&#34;))
        self.assertIn(md5(message.encode()).hexdigest(),
                      self.computer.run_command(&#34;md5sum&#34;, [&#34;file&#34;, &#34;-z&#34;], True).data.strip(&#34;\n&#34;))
        self.assertEqual(self.computer.run_command(&#34;md5sum&#34;, [&#34;file&#34;, &#34;-z&#34;, &#34;--tag&#34;], True).data.strip(&#34;\n&#34;),
                         f&#34;MD5 (file) = {md5(message.encode()).hexdigest()}&#34;)

    def test_mv(self):
        self.computer.run_command(&#34;mv&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;mv&#34;, [&#34;--help&#34;], True)

        # Make sure /bin/pwd exists
        find_pwd = self.computer.fs.find(&#34;/bin/pwd&#34;)
        self.assertTrue(find_pwd.success)

        # Make sure permissions work when moving
        self.assertFalse(self.computer.run_command(&#34;mv&#34;, [&#34;/bin/pwd&#34;, &#34;/tmp&#34;], True).success)

        # Make sure /bin/pwd still exists
        find_pwd = self.computer.fs.find(&#34;/bin/pwd&#34;)
        self.assertTrue(find_pwd.success)

        # Make sure /tmp/pwd DOESN&#39;T exists
        find_pwd = self.computer.fs.find(&#34;/tmp/pwd&#34;)
        self.assertFalse(find_pwd.success)

        # Root perms!
        self.computer.sessions.append(Session(0, self.computer.fs.files, self.computer.sessions[-1].id + 1))

        self.computer.run_command(&#34;mv&#34;, [&#34;/bin/pwd&#34;, &#34;/tmp&#34;], True)

        # Make sure /bin/pwd DOESN&#39;T exists
        find_pwd = self.computer.fs.find(&#34;/bin/pwd&#34;)
        self.assertFalse(find_pwd.success)

        # Make sure /tmp/pwd exists
        find_pwd = self.computer.fs.find(&#34;/tmp/pwd&#34;)
        self.assertTrue(find_pwd.success)

    def test_printenv(self):
        self.computer.run_command(&#34;printenv&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;printenv&#34;, [&#34;--help&#34;], True)

        env_result = self.computer.run_command(&#34;printenv&#34;, [], True).data.strip(&#34;\n&#34;)
        self.assertEqual(env_result, &#34;PATH=/usr/bin:/bin\nHOME=/home/steve\nUSER=steve&#34;)

    def test_pwd(self):
        self.computer.run_command(&#34;pwd&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;pwd&#34;, [&#34;--help&#34;], True)

        pwd_result = self.computer.run_command(&#34;pwd&#34;, [], True).data.strip(&#34;\n&#34;)

        self.assertEqual(&#34;/home/steve&#34;, pwd_result)

    def test_sha1sum(self):
        self.computer.run_command(&#34;sha1sum&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;sha1sum&#34;, [&#34;--help&#34;], True)

        message = &#34;hello!&#34;

        self.computer.run_command(&#34;touch&#34;, [&#34;file&#34;], True)
        # We&#39;re writing with a new line to replicate what `echo hello! &gt; file` would do
        self.computer.fs.find(&#34;/home/steve/file&#34;).data.write(message + &#34;\n&#34;, self.computer)

        self.assertIn(sha1((message + &#34;\n&#34;).encode()).hexdigest(),
                      self.computer.run_command(&#34;sha1sum&#34;, [&#34;file&#34;], True).data.strip(&#34;\n&#34;))
        self.assertIn(sha1(message.encode()).hexdigest(),
                      self.computer.run_command(&#34;sha1sum&#34;, [&#34;file&#34;, &#34;-z&#34;], True).data.strip(&#34;\n&#34;))
        self.assertEqual(self.computer.run_command(&#34;sha1sum&#34;, [&#34;file&#34;, &#34;-z&#34;, &#34;--tag&#34;], True).data.strip(&#34;\n&#34;),
                         f&#34;SHA1 (file) = {sha1(message.encode()).hexdigest()}&#34;)

    def test_sha224sum(self):
        self.computer.run_command(&#34;sha224sum&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;sha224sum&#34;, [&#34;--help&#34;], True)

        message = &#34;hello!&#34;

        self.computer.run_command(&#34;touch&#34;, [&#34;file&#34;], True)
        # We&#39;re writing with a new line to replicate what `echo hello! &gt; file` would do
        self.computer.fs.find(&#34;/home/steve/file&#34;).data.write(message + &#34;\n&#34;, self.computer)

        self.assertIn(sha224((message + &#34;\n&#34;).encode()).hexdigest(),
                      self.computer.run_command(&#34;sha224sum&#34;, [&#34;file&#34;], True).data.strip(&#34;\n&#34;))
        self.assertIn(sha224(message.encode()).hexdigest(),
                      self.computer.run_command(&#34;sha224sum&#34;, [&#34;file&#34;, &#34;-z&#34;], True).data.strip(&#34;\n&#34;))
        self.assertEqual(self.computer.run_command(&#34;sha224sum&#34;, [&#34;file&#34;, &#34;-z&#34;, &#34;--tag&#34;], True).data.strip(&#34;\n&#34;),
                         f&#34;SHA224 (file) = {sha224(message.encode()).hexdigest()}&#34;)

    def test_sha256sum(self):
        self.computer.run_command(&#34;sha256sum&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;sha256sum&#34;, [&#34;--help&#34;], True)

        message = &#34;hello!&#34;

        self.computer.run_command(&#34;touch&#34;, [&#34;file&#34;], True)
        # We&#39;re writing with a new line to replicate what `echo hello! &gt; file` would do
        self.computer.fs.find(&#34;/home/steve/file&#34;).data.write(message + &#34;\n&#34;, self.computer)

        self.assertIn(sha256((message + &#34;\n&#34;).encode()).hexdigest(),
                      self.computer.run_command(&#34;sha256sum&#34;, [&#34;file&#34;], True).data.strip(&#34;\n&#34;))
        self.assertIn(sha256(message.encode()).hexdigest(),
                      self.computer.run_command(&#34;sha256sum&#34;, [&#34;file&#34;, &#34;-z&#34;], True).data.strip(&#34;\n&#34;))
        self.assertEqual(self.computer.run_command(&#34;sha256sum&#34;, [&#34;file&#34;, &#34;-z&#34;, &#34;--tag&#34;], True).data.strip(&#34;\n&#34;),
                         f&#34;SHA256 (file) = {sha256(message.encode()).hexdigest()}&#34;)

    def test_sha384sum(self):
        self.computer.run_command(&#34;sha384sum&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;sha384sum&#34;, [&#34;--help&#34;], True)

        message = &#34;hello!&#34;

        self.computer.run_command(&#34;touch&#34;, [&#34;file&#34;], True)
        # We&#39;re writing with a new line to replicate what `echo hello! &gt; file` would do
        self.computer.fs.find(&#34;/home/steve/file&#34;).data.write(message + &#34;\n&#34;, self.computer)

        self.assertIn(sha384((message + &#34;\n&#34;).encode()).hexdigest(),
                      self.computer.run_command(&#34;sha384sum&#34;, [&#34;file&#34;], True).data.strip(&#34;\n&#34;))
        self.assertIn(sha384(message.encode()).hexdigest(),
                      self.computer.run_command(&#34;sha384sum&#34;, [&#34;file&#34;, &#34;-z&#34;], True).data.strip(&#34;\n&#34;))
        self.assertEqual(self.computer.run_command(&#34;sha384sum&#34;, [&#34;file&#34;, &#34;-z&#34;, &#34;--tag&#34;], True).data.strip(&#34;\n&#34;),
                         f&#34;SHA384 (file) = {sha384(message.encode()).hexdigest()}&#34;)

    def test_sha512sum(self):
        self.computer.run_command(&#34;sha512sum&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;sha512sum&#34;, [&#34;--help&#34;], True)

        message = &#34;hello!&#34;

        self.computer.run_command(&#34;touch&#34;, [&#34;file&#34;], True)
        # We&#39;re writing with a new line to replicate what `echo hello! &gt; file` would do
        self.computer.fs.find(&#34;/home/steve/file&#34;).data.write(message + &#34;\n&#34;, self.computer)

        self.assertIn(sha512((message + &#34;\n&#34;).encode()).hexdigest(),
                      self.computer.run_command(&#34;sha512sum&#34;, [&#34;file&#34;], True).data.strip(&#34;\n&#34;))
        self.assertIn(sha512(message.encode()).hexdigest(),
                      self.computer.run_command(&#34;sha512sum&#34;, [&#34;file&#34;, &#34;-z&#34;], True).data.strip(&#34;\n&#34;))
        self.assertEqual(self.computer.run_command(&#34;sha512sum&#34;, [&#34;file&#34;, &#34;-z&#34;, &#34;--tag&#34;], True).data.strip(&#34;\n&#34;),
                         f&#34;SHA512 (file) = {sha512(message.encode()).hexdigest()}&#34;)

    def test_touch(self):
        self.computer.run_command(&#34;touch&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;touch&#34;, [&#34;--help&#34;], True)

        touch_result = self.computer.run_command(&#34;touch&#34;, [&#34;testfile&#34;], True)
        expected_touch_result = Result(success=True)

        # We should double check that the file exists in our home directory
        self.assertIn(&#34;testfile&#34;, self.computer.run_command(&#34;ls&#34;, [], True).data)

        self.assertEqual(touch_result, expected_touch_result)

    def test_uname(self):
        self.computer.run_command(&#34;uname&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;uname&#34;, [&#34;--help&#34;], True)

        # Test some misc uname configurations
        self.assertEqual(self.computer.run_command(&#34;uname&#34;, [], True).data.strip(&#34;\n&#34;), &#34;Linux&#34;)
        self.assertEqual(self.computer.run_command(&#34;uname&#34;, [&#34;-a&#34;], True).data.strip(&#34;\n&#34;),
                         f&#34;Linux {self.computer.hostname} 1.1 v1 x86_64 Blackhat/Linux&#34;)
        self.assertEqual(self.computer.run_command(&#34;uname&#34;, [&#34;-mns&#34;], True).data.strip(&#34;\n&#34;),
                         f&#34;Linux {self.computer.hostname} x86_64 &#34;)
        self.assertEqual(self.computer.run_command(&#34;uname&#34;, [&#34;-op&#34;, &#34;-i&#34;], True).data.strip(&#34;\n&#34;),
                         &#34;unknown unknown Blackhat/Linux &#34;)

    def test_unset(self):
        self.computer.run_command(&#34;unset&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;unset&#34;, [&#34;--help&#34;], True)

        # Lets get a baseline for the env before-hand
        env_result = self.computer.run_command(&#34;printenv&#34;, [], True).data.strip(&#34;\n&#34;)
        self.assertEqual(env_result, &#34;PATH=/usr/bin:/bin\nHOME=/home/steve\nUSER=steve&#34;)

        self.computer.run_command(&#34;export&#34;, [&#34;BASH=/bin/bash&#34;], True)

        env_result = self.computer.run_command(&#34;printenv&#34;, [], True).data.strip(&#34;\n&#34;)
        self.assertEqual(env_result, &#34;PATH=/usr/bin:/bin\nHOME=/home/steve\nUSER=steve\nBASH=/bin/bash&#34;)

        self.computer.run_command(&#34;unset&#34;, [&#34;BASH&#34;], True)
        env_result = self.computer.run_command(&#34;printenv&#34;, [], True).data.strip(&#34;\n&#34;)
        self.assertEqual(env_result, &#34;PATH=/usr/bin:/bin\nHOME=/home/steve\nUSER=steve&#34;)

    def test_uptime(self):
        self.computer.run_command(&#34;uptime&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;uptime&#34;, [&#34;--help&#34;], True)

        # Make sure it doesn&#39;t crash
        uptime_result = self.computer.run_command(&#34;uptime&#34;, [], True).data.strip(&#34;\n&#34;)
        # TODO: See if there&#39;s a better way to fix this without wasting 5 seconds
        self.assertEqual(uptime_result, &#34;uptime: 0:00:00&#34;)

        sleep(5)
        uptime_result = self.computer.run_command(&#34;uptime&#34;, [], True).data.strip(&#34;\n&#34;)
        self.assertEqual(uptime_result, &#34;uptime: 0:00:05&#34;)

        uptime_result = self.computer.run_command(&#34;uptime&#34;, [&#34;-p&#34;], True).data.strip(&#34;\n&#34;)
        self.assertEqual(uptime_result, &#34;up 0 minutes&#34;)

        now = datetime.datetime.now().strftime(&#34;%Y-%m-%d %H:%M:%S&#34;)
        uptime_result = self.computer.run_command(&#34;uptime&#34;, [&#34;-s&#34;], True).data.strip(&#34;\n&#34;)

        # I&#39;m going to strip out the seconds because different speed test runners can take different amount of times
        # to run

        now = &#34;:&#34;.join(now.split(&#34;:&#34;)[:-1])
        uptime_result = &#34;:&#34;.join(uptime_result.split(&#34;:&#34;)[:-1])

        self.assertEqual(now, uptime_result)

    def test_users(self):
        self.computer.run_command(&#34;users&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;users&#34;, [&#34;--help&#34;], True)

        # One session = only one user
        users_result = self.computer.run_command(&#34;users&#34;, [], True).data.strip(&#34;\n&#34;)
        self.assertEqual(users_result, &#34;steve &#34;)

        # Add new sessions then test
        self.computer.sessions.append(Session(0, self.computer.fs.files, self.computer.sessions[-1].id + 1))
        users_result = self.computer.run_command(&#34;users&#34;, [], True).data.strip(&#34;\n&#34;)
        self.assertEqual(users_result, &#34;steve root &#34;)

        self.computer.sessions.append(Session(1000, self.computer.fs.files, self.computer.sessions[-1].id + 1))
        users_result = self.computer.run_command(&#34;users&#34;, [], True).data.strip(&#34;\n&#34;)
        self.assertEqual(users_result, &#34;steve root steve &#34;)

    def test_wc(self):
        self.computer.run_command(&#34;wc&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;wc&#34;, [&#34;--help&#34;], True)

        message = &#34;hello!&#34;
        message_len = len(message + &#34;\n&#34;)

        self.computer.run_command(&#34;touch&#34;, [&#34;file&#34;], True)
        # We&#39;re writing with a new line to replicate what `echo hello! &gt; file` would do
        self.computer.fs.find(&#34;/home/steve/file&#34;).data.write(message + &#34;\n&#34;, self.computer)

        wc_result = self.computer.run_command(&#34;wc&#34;, [&#34;file&#34;], True).data.strip(&#34;\n&#34;)

        wc_split_results = wc_result.split(&#34; &#34;)
        while &#34;&#34; in wc_split_results:
            wc_split_results.remove(&#34;&#34;)

        total_new_line_count, total_word_count, total_byte_count = wc_split_results[0], wc_split_results[1], \
                                                                   wc_split_results[2]

        self.assertEqual(int(total_byte_count), message_len)
        self.assertEqual(int(total_new_line_count), 1)
        self.assertEqual(int(total_word_count), 1)

        wc_result = self.computer.run_command(&#34;wc&#34;, [&#34;file&#34;, &#34;-c&#34;], True).data.strip(&#34;\n&#34;)

        wc_split_results = wc_result.split(&#34; &#34;)
        while &#34;&#34; in wc_split_results:
            wc_split_results.remove(&#34;&#34;)

        total_byte_count = wc_split_results[0]

        self.assertEqual(int(total_byte_count), message_len)

        wc_result = self.computer.run_command(&#34;wc&#34;, [&#34;file&#34;, &#34;-m&#34;], True).data.strip(&#34;\n&#34;)

        wc_split_results = wc_result.split(&#34; &#34;)
        while &#34;&#34; in wc_split_results:
            wc_split_results.remove(&#34;&#34;)

        total_byte_count = wc_split_results[0]

        self.assertEqual(int(total_byte_count), message_len)

    def test_who(self):
        self.computer.run_command(&#34;who&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;who&#34;, [&#34;--help&#34;], True)

        who_result = self.computer.run_command(&#34;who&#34;, [], True).data.strip(&#34;\n&#34;)
        self.assertEqual(who_result, &#34;steve\tpts/0&#34;)

    def test_whoami(self):
        self.computer.run_command(&#34;whoami&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;whoami&#34;, [&#34;--help&#34;], True)

        whoami_result = self.computer.run_command(&#34;whoami&#34;, [], True).data.strip(&#34;\n&#34;)

        self.assertEqual(whoami_result, &#34;steve&#34;)


class TestInstallableBinaries(unittest.TestCase):
    &#34;&#34;&#34;
    These test cases test the functionality of the binaries that are NOT included with the system
    (anything installable through apt)
    This is anything in the client/blackhat/bin/installable folder
    &#34;&#34;&#34;

    def setUp(self) -&gt; None:
        self.computer = init()</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="blackhat.tests.test_binaries.TestIncludedBinaries"><code class="flex name class">
<span>class <span class="ident">TestIncludedBinaries</span></span>
<span>(</span><span>methodName='runTest')</span>
</code></dt>
<dd>
<div class="desc"><p>These test cases test the functionality of the binaries that are included with the system
This is anything in the client/blackhat/bin folder (not including files in the installable folder)</p>
<p>Create an instance of the class that will use the named test
method when executed. Raises a ValueError if the instance does
not have a method with the specified name.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class TestIncludedBinaries(unittest.TestCase):
    &#34;&#34;&#34;
    These test cases test the functionality of the binaries that are included with the system
    This is anything in the client/blackhat/bin folder (not including files in the installable folder)
    &#34;&#34;&#34;

    def setUp(self) -&gt; None:
        self.computer = init()

    def test_add_user(self):
        self.computer.run_command(&#34;adduser&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;adduser&#34;, [&#34;--help&#34;], True)

        fail_bc_not_root_result = self.computer.run_command(&#34;adduser&#34;, [&#34;testuser&#34;, &#34;-p&#34; &#34;password&#34;, &#34;-n&#34;], True)
        expected_fail_bc_not_root_result = Result(success=False, message=ResultMessages.NOT_ALLOWED,
                                                  data=&#34;adduser: Only root can add new users!\n&#34;)

        self.assertEqual(fail_bc_not_root_result, expected_fail_bc_not_root_result)

        self.computer.sessions.append(Session(0, self.computer.fs.files, self.computer.sessions[-1].id + 1))

        create_new_user_result = self.computer.run_command(&#34;adduser&#34;, [&#34;testuser&#34;, &#34;-p&#34; &#34;password&#34;, &#34;-n&#34;], True)
        expected_create_new_user_result = Result(success=True, message=None, data=None)
        create_duplicate_user_result = self.computer.run_command(&#34;adduser&#34;, [&#34;testuser&#34;, &#34;-p&#34; &#34;password&#34;, &#34;-n&#34;], True)
        expected_create_duplicate_user_result = Result(success=False, message=ResultMessages.ALREADY_EXISTS,
                                                       data=&#34;adduser: The user &#39;testuser&#39; already exists.\n&#34;)

        self.assertEqual(create_new_user_result, expected_create_new_user_result)
        self.assertEqual(create_duplicate_user_result, expected_create_duplicate_user_result)

        # Now confirm that the user was actually added
        get_user_result = self.computer.get_user(username=&#34;testuser&#34;)
        expected_get_user_result = Result(success=True, message=None,
                                          data=User(1001, &#34;testuser&#34;, md5(&#34;password&#34;.encode()).hexdigest()))
        self.assertEqual(get_user_result, expected_get_user_result)

    def test_base32(self):
        self.computer.run_command(&#34;base32&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;base32&#34;, [&#34;--help&#34;], True)

        message = &#34;Hello!&#34;

        self.computer.run_command(&#34;touch&#34;, [&#34;file&#34;], True)
        # We&#39;re writing with a new line to replicate what `echo hello! &gt; file` would do
        self.computer.fs.find(&#34;/home/steve/file&#34;).data.write(message + &#34;\n&#34;, self.computer)

        base32_result = self.computer.run_command(&#34;base32&#34;, [&#34;file&#34;], True).data.replace(&#34;\n&#34;, &#34;&#34;).split(&#34; &#34;)[1]
        self.assertEqual(b32decode(base32_result).decode().strip(&#34;\n&#34;), message)

    def test_base64(self):
        self.computer.run_command(&#34;base64&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;base64&#34;, [&#34;--help&#34;], True)

        message = &#34;Hello!&#34;

        self.computer.run_command(&#34;touch&#34;, [&#34;file&#34;], True)
        # We&#39;re writing with a new line to replicate what `echo hello! &gt; file` would do
        self.computer.fs.find(&#34;/home/steve/file&#34;).data.write(message + &#34;\n&#34;, self.computer)

        base64_result = self.computer.run_command(&#34;base64&#34;, [&#34;file&#34;], True).data.replace(&#34;\n&#34;, &#34;&#34;).split(&#34; &#34;)[1]
        self.assertEqual(b64decode(base64_result).decode().strip(&#34;\n&#34;), message)

    def test_cd(self):
        self.computer.run_command(&#34;cd&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;cd&#34;, [&#34;--help&#34;], True)

        self.assertEqual(self.computer.sys_getcwd().pwd(), &#34;/home/steve&#34;)
        self.computer.run_command(&#34;cd&#34;, [&#34;..&#34;], True)
        self.assertEqual(self.computer.sys_getcwd().pwd(), &#34;/home&#34;)
        self.computer.run_command(&#34;cd&#34;, [&#34;...&#34;], True)
        self.assertEqual(self.computer.sys_getcwd().pwd(), &#34;/&#34;)
        self.computer.run_command(&#34;cd&#34;, [&#34;/etc/skel/Desktop&#34;], True)
        self.assertEqual(self.computer.sys_getcwd().pwd(), &#34;/etc/skel/Desktop&#34;)
        self.computer.run_command(&#34;cd&#34;, [&#34;~&#34;], True)
        self.assertEqual(self.computer.sys_getcwd().pwd(), &#34;/home/steve&#34;)

    def test_chown(self):
        self.computer.run_command(&#34;chown&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;chown&#34;, [&#34;--help&#34;], True)

        self.computer.run_command(&#34;touch&#34;, [&#34;testfile&#34;], True)

        self.assertEqual(self.computer.fs.find(&#34;/home/steve/testfile&#34;).data.owner, 1000)
        self.assertEqual(self.computer.fs.find(&#34;/home/steve/testfile&#34;).data.group_owner, 1000)

        self.computer.run_command(&#34;chown&#34;, [&#34;root:root&#34;, &#34;testfile&#34;], True)
        self.assertEqual(self.computer.fs.find(&#34;/home/steve/testfile&#34;).data.owner, 0)
        self.assertEqual(self.computer.fs.find(&#34;/home/steve/testfile&#34;).data.group_owner, 0)

    def test_clear(self):
        self.computer.run_command(&#34;clear&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;clear&#34;, [&#34;--help&#34;], True)

        self.computer.run_command(&#34;clear&#34;, [], True)

    def test_commands(self):
        self.computer.run_command(&#34;commands&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;commands&#34;, [&#34;--help&#34;], True)

        commands_result = self.computer.run_command(&#34;commands&#34;, [], True).data.strip(&#34;\n&#34;)
        self.assertIn(&#34;ls&#34;, commands_result)

        # Now lets remove ls from /bin (it shouldn&#39;t show up in commands)
        # We need root permissions
        self.computer.sessions.append(Session(0, self.computer.fs.files, self.computer.sessions[-1].id + 1))
        move_result = self.computer.run_command(&#34;mv&#34;, [&#34;/bin/ls&#34;, &#34;/tmp&#34;], True)
        self.assertTrue(move_result.success)

        commands_result = self.computer.run_command(&#34;commands&#34;, [], True).data.strip(&#34;\n&#34;)
        self.assertNotIn(&#34;ls&#34;, commands_result)

    def test_date(self):
        self.computer.run_command(&#34;date&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;date&#34;, [&#34;--help&#34;], True)

        date_result = self.computer.run_command(&#34;date&#34;, [], True)

        local_timezone = datetime.datetime.now(datetime.timezone.utc).astimezone().tzinfo
        time_first = datetime.datetime.now().strftime(&#39;%a %b %d %I:%M:%S %p&#39;)
        time_second = datetime.datetime.now().strftime(&#39;%Y&#39;)

        expected_result = f&#34;{time_first} {local_timezone} {time_second}&#34;

        self.assertEqual(date_result.data.strip(&#34;\n&#34;), expected_result)

    def test_echo(self):
        self.computer.run_command(&#34;echo&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;echo&#34;, [&#34;--help&#34;], True)

        echo_result = self.computer.run_command(&#34;echo&#34;, [&#34;hello!&#34;], True)
        self.assertEqual(echo_result.data, &#34;hello!\n&#34;)

        # Test -e flag
        echo_e_flag_result = self.computer.run_command(&#34;echo&#34;, [&#34;-e&#34;, &#34;hello\n\tworld!&#34;], True)
        self.assertEqual(echo_e_flag_result.data, &#34;hello\n\tworld!\n&#34;)

        # Test -n flag
        echo_n_flag_result = self.computer.run_command(&#34;echo&#34;, [&#34;-n&#34;, &#34;hello world!\n&#34;], True)
        self.assertEqual(echo_n_flag_result.data, &#34;hello world!\n&#34;)

    def test_env(self):
        self.computer.run_command(&#34;env&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;env&#34;, [&#34;--help&#34;], True)

        env_result = self.computer.run_command(&#34;env&#34;, [], True).data.strip(&#34;\n&#34;)
        print(f&#34;ENVRESULT: {env_result}&#34;)
        self.assertEqual(env_result, &#34;PATH=/usr/bin:/bin\nHOME=/home/steve\nUSER=steve&#34;)

    def test_export(self):
        self.computer.run_command(&#34;export&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;export&#34;, [&#34;--help&#34;], True)

        # Lets get a baseline for the env before-hand
        env_result = self.computer.run_command(&#34;printenv&#34;, [], True).data.strip(&#34;\n&#34;)
        self.assertEqual(env_result, &#34;PATH=/usr/bin:/bin\nHOME=/home/steve\nUSER=steve&#34;)

        self.computer.run_command(&#34;export&#34;, [&#34;BASH=/bin/bash&#34;], True)

        env_result = self.computer.run_command(&#34;printenv&#34;, [], True).data.strip(&#34;\n&#34;)
        self.assertEqual(env_result, &#34;PATH=/usr/bin:/bin\nHOME=/home/steve\nUSER=steve\nBASH=/bin/bash&#34;)

    def test_hostname(self):
        self.computer.run_command(&#34;hostname&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;hostname&#34;, [&#34;--help&#34;], True)

        # We want to try to set the hostname without root permission (should fail)
        set_hostname_result = self.computer.run_command(&#34;hostname&#34;, [&#34;localhost&#34;], True)
        expected_set_hostname_result = Result(success=False,
                                              data=&#34;hostname: you must be root to change the host name&#34;)

        set_hostname_result.data = set_hostname_result.data.strip(&#34;\n&#34;)

        self.assertEqual(set_hostname_result, expected_set_hostname_result)

        # Make sure it failed
        get_hostname_result = self.computer.run_command(&#34;hostname&#34;, [], True)

        self.assertNotEqual(get_hostname_result.data, &#34;localhost&#34;)

        # Switch to root then change hostname
        self.computer.sessions.append(Session(0, self.computer.fs.files, self.computer.sessions[-1].id + 1))

        self.computer.run_command(&#34;hostname&#34;, [&#34;localhost&#34;], True)
        get_hostname_result = self.computer.run_command(&#34;hostname&#34;, [], True)

        self.assertEqual(get_hostname_result.data.strip(&#34;\n&#34;), &#34;localhost&#34;)

    def test_id(self):
        self.computer.run_command(&#34;id&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;id&#34;, [&#34;--help&#34;], True)

        self_id_result = self.computer.run_command(&#34;id&#34;, [], True).data.strip(&#34;\n&#34;)
        expected_self_id_result = &#34;uid=1000(steve) gid=1000(steve) &#34;
        self.assertEqual(self_id_result, expected_self_id_result)

        root_id_result = self.computer.run_command(&#34;id&#34;, [&#34;root&#34;], True).data.strip(&#34;\n&#34;)
        root_id_by_uid_result = self.computer.run_command(&#34;id&#34;, [&#34;0&#34;], True).data.strip(&#34;\n&#34;)
        expected_root_result = &#34;uid=0(root) gid=0(root) &#34;
        self.assertEqual(root_id_result, expected_root_result)
        self.assertEqual(root_id_by_uid_result, expected_root_result)

        # Check the flags
        id_result = self.computer.run_command(&#34;id&#34;, [&#34;-g&#34;], True).data.strip(&#34;\n&#34;)
        self.assertEqual(id_result, &#34;1000&#34;)

        id_result = self.computer.run_command(&#34;id&#34;, [&#34;-G&#34;], True).data.strip(&#34;\n&#34;)
        self.assertEqual(id_result, &#34;1000&#34;)

        id_result = self.computer.run_command(&#34;id&#34;, [&#34;-n&#34;], True).data.strip(&#34;\n&#34;)
        self.assertEqual(id_result, &#34;steve&#34;)

    def test_ls(self):
        import re
        self.computer.run_command(&#34;ls&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;ls&#34;, [&#34;--help&#34;], True)

        # In the user&#39;s home directory, The files should be: Desktop Documents Downloads Music Pictures Public Templates Videos
        ls_result = self.computer.run_command(&#34;ls&#34;, [&#34;--no-color&#34;], True)
        expected_ls_result = Result(success=True, message=None,
                                    data=&#34;Desktop Documents Downloads Music Pictures Public Templates Videos &#34;)

        ls_result.data = ls_result.data.strip(&#34;\n&#34;)

        print(ls_result)
        print(expected_ls_result)

        color_filter = re.compile(r&#39;\x1b[^m]*m&#39;)
        stripped_color = color_filter.sub(&#39;&#39;, ls_result.data)

        self.assertEqual(stripped_color, expected_ls_result.data)
        # Make sure .shellrc isn&#39;t there (as -a isn&#39;t specified)
        self.assertNotIn(&#34;.shellrc&#34;, ls_result.data)

        # Test -a flag (show hidden files)
        ls_result = self.computer.run_command(&#34;ls&#34;, [&#34;--no-color&#34;, &#34;-a&#34;], True)
        self.assertIn(&#34;.shellrc&#34;, ls_result.data)

        # Make sure -l flag works
        ls_result = self.computer.run_command(&#34;ls&#34;, [&#34;--no-color&#34;, &#34;-l&#34;], True)
        self.assertIn(&#34;steve&#34;, ls_result.data)

    def test_md5sum(self):
        self.computer.run_command(&#34;md5sum&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;md5sum&#34;, [&#34;--help&#34;], True)

        message = &#34;hello!&#34;

        self.computer.run_command(&#34;touch&#34;, [&#34;file&#34;], True)
        # We&#39;re writing with a new line to replicate what `echo hello! &gt; file` would do
        self.computer.fs.find(&#34;/home/steve/file&#34;).data.write(message + &#34;\n&#34;, self.computer)

        self.assertIn(md5((message + &#34;\n&#34;).encode()).hexdigest(),
                      self.computer.run_command(&#34;md5sum&#34;, [&#34;file&#34;], True).data.strip(&#34;\n&#34;))
        self.assertIn(md5(message.encode()).hexdigest(),
                      self.computer.run_command(&#34;md5sum&#34;, [&#34;file&#34;, &#34;-z&#34;], True).data.strip(&#34;\n&#34;))
        self.assertEqual(self.computer.run_command(&#34;md5sum&#34;, [&#34;file&#34;, &#34;-z&#34;, &#34;--tag&#34;], True).data.strip(&#34;\n&#34;),
                         f&#34;MD5 (file) = {md5(message.encode()).hexdigest()}&#34;)

    def test_mv(self):
        self.computer.run_command(&#34;mv&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;mv&#34;, [&#34;--help&#34;], True)

        # Make sure /bin/pwd exists
        find_pwd = self.computer.fs.find(&#34;/bin/pwd&#34;)
        self.assertTrue(find_pwd.success)

        # Make sure permissions work when moving
        self.assertFalse(self.computer.run_command(&#34;mv&#34;, [&#34;/bin/pwd&#34;, &#34;/tmp&#34;], True).success)

        # Make sure /bin/pwd still exists
        find_pwd = self.computer.fs.find(&#34;/bin/pwd&#34;)
        self.assertTrue(find_pwd.success)

        # Make sure /tmp/pwd DOESN&#39;T exists
        find_pwd = self.computer.fs.find(&#34;/tmp/pwd&#34;)
        self.assertFalse(find_pwd.success)

        # Root perms!
        self.computer.sessions.append(Session(0, self.computer.fs.files, self.computer.sessions[-1].id + 1))

        self.computer.run_command(&#34;mv&#34;, [&#34;/bin/pwd&#34;, &#34;/tmp&#34;], True)

        # Make sure /bin/pwd DOESN&#39;T exists
        find_pwd = self.computer.fs.find(&#34;/bin/pwd&#34;)
        self.assertFalse(find_pwd.success)

        # Make sure /tmp/pwd exists
        find_pwd = self.computer.fs.find(&#34;/tmp/pwd&#34;)
        self.assertTrue(find_pwd.success)

    def test_printenv(self):
        self.computer.run_command(&#34;printenv&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;printenv&#34;, [&#34;--help&#34;], True)

        env_result = self.computer.run_command(&#34;printenv&#34;, [], True).data.strip(&#34;\n&#34;)
        self.assertEqual(env_result, &#34;PATH=/usr/bin:/bin\nHOME=/home/steve\nUSER=steve&#34;)

    def test_pwd(self):
        self.computer.run_command(&#34;pwd&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;pwd&#34;, [&#34;--help&#34;], True)

        pwd_result = self.computer.run_command(&#34;pwd&#34;, [], True).data.strip(&#34;\n&#34;)

        self.assertEqual(&#34;/home/steve&#34;, pwd_result)

    def test_sha1sum(self):
        self.computer.run_command(&#34;sha1sum&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;sha1sum&#34;, [&#34;--help&#34;], True)

        message = &#34;hello!&#34;

        self.computer.run_command(&#34;touch&#34;, [&#34;file&#34;], True)
        # We&#39;re writing with a new line to replicate what `echo hello! &gt; file` would do
        self.computer.fs.find(&#34;/home/steve/file&#34;).data.write(message + &#34;\n&#34;, self.computer)

        self.assertIn(sha1((message + &#34;\n&#34;).encode()).hexdigest(),
                      self.computer.run_command(&#34;sha1sum&#34;, [&#34;file&#34;], True).data.strip(&#34;\n&#34;))
        self.assertIn(sha1(message.encode()).hexdigest(),
                      self.computer.run_command(&#34;sha1sum&#34;, [&#34;file&#34;, &#34;-z&#34;], True).data.strip(&#34;\n&#34;))
        self.assertEqual(self.computer.run_command(&#34;sha1sum&#34;, [&#34;file&#34;, &#34;-z&#34;, &#34;--tag&#34;], True).data.strip(&#34;\n&#34;),
                         f&#34;SHA1 (file) = {sha1(message.encode()).hexdigest()}&#34;)

    def test_sha224sum(self):
        self.computer.run_command(&#34;sha224sum&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;sha224sum&#34;, [&#34;--help&#34;], True)

        message = &#34;hello!&#34;

        self.computer.run_command(&#34;touch&#34;, [&#34;file&#34;], True)
        # We&#39;re writing with a new line to replicate what `echo hello! &gt; file` would do
        self.computer.fs.find(&#34;/home/steve/file&#34;).data.write(message + &#34;\n&#34;, self.computer)

        self.assertIn(sha224((message + &#34;\n&#34;).encode()).hexdigest(),
                      self.computer.run_command(&#34;sha224sum&#34;, [&#34;file&#34;], True).data.strip(&#34;\n&#34;))
        self.assertIn(sha224(message.encode()).hexdigest(),
                      self.computer.run_command(&#34;sha224sum&#34;, [&#34;file&#34;, &#34;-z&#34;], True).data.strip(&#34;\n&#34;))
        self.assertEqual(self.computer.run_command(&#34;sha224sum&#34;, [&#34;file&#34;, &#34;-z&#34;, &#34;--tag&#34;], True).data.strip(&#34;\n&#34;),
                         f&#34;SHA224 (file) = {sha224(message.encode()).hexdigest()}&#34;)

    def test_sha256sum(self):
        self.computer.run_command(&#34;sha256sum&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;sha256sum&#34;, [&#34;--help&#34;], True)

        message = &#34;hello!&#34;

        self.computer.run_command(&#34;touch&#34;, [&#34;file&#34;], True)
        # We&#39;re writing with a new line to replicate what `echo hello! &gt; file` would do
        self.computer.fs.find(&#34;/home/steve/file&#34;).data.write(message + &#34;\n&#34;, self.computer)

        self.assertIn(sha256((message + &#34;\n&#34;).encode()).hexdigest(),
                      self.computer.run_command(&#34;sha256sum&#34;, [&#34;file&#34;], True).data.strip(&#34;\n&#34;))
        self.assertIn(sha256(message.encode()).hexdigest(),
                      self.computer.run_command(&#34;sha256sum&#34;, [&#34;file&#34;, &#34;-z&#34;], True).data.strip(&#34;\n&#34;))
        self.assertEqual(self.computer.run_command(&#34;sha256sum&#34;, [&#34;file&#34;, &#34;-z&#34;, &#34;--tag&#34;], True).data.strip(&#34;\n&#34;),
                         f&#34;SHA256 (file) = {sha256(message.encode()).hexdigest()}&#34;)

    def test_sha384sum(self):
        self.computer.run_command(&#34;sha384sum&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;sha384sum&#34;, [&#34;--help&#34;], True)

        message = &#34;hello!&#34;

        self.computer.run_command(&#34;touch&#34;, [&#34;file&#34;], True)
        # We&#39;re writing with a new line to replicate what `echo hello! &gt; file` would do
        self.computer.fs.find(&#34;/home/steve/file&#34;).data.write(message + &#34;\n&#34;, self.computer)

        self.assertIn(sha384((message + &#34;\n&#34;).encode()).hexdigest(),
                      self.computer.run_command(&#34;sha384sum&#34;, [&#34;file&#34;], True).data.strip(&#34;\n&#34;))
        self.assertIn(sha384(message.encode()).hexdigest(),
                      self.computer.run_command(&#34;sha384sum&#34;, [&#34;file&#34;, &#34;-z&#34;], True).data.strip(&#34;\n&#34;))
        self.assertEqual(self.computer.run_command(&#34;sha384sum&#34;, [&#34;file&#34;, &#34;-z&#34;, &#34;--tag&#34;], True).data.strip(&#34;\n&#34;),
                         f&#34;SHA384 (file) = {sha384(message.encode()).hexdigest()}&#34;)

    def test_sha512sum(self):
        self.computer.run_command(&#34;sha512sum&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;sha512sum&#34;, [&#34;--help&#34;], True)

        message = &#34;hello!&#34;

        self.computer.run_command(&#34;touch&#34;, [&#34;file&#34;], True)
        # We&#39;re writing with a new line to replicate what `echo hello! &gt; file` would do
        self.computer.fs.find(&#34;/home/steve/file&#34;).data.write(message + &#34;\n&#34;, self.computer)

        self.assertIn(sha512((message + &#34;\n&#34;).encode()).hexdigest(),
                      self.computer.run_command(&#34;sha512sum&#34;, [&#34;file&#34;], True).data.strip(&#34;\n&#34;))
        self.assertIn(sha512(message.encode()).hexdigest(),
                      self.computer.run_command(&#34;sha512sum&#34;, [&#34;file&#34;, &#34;-z&#34;], True).data.strip(&#34;\n&#34;))
        self.assertEqual(self.computer.run_command(&#34;sha512sum&#34;, [&#34;file&#34;, &#34;-z&#34;, &#34;--tag&#34;], True).data.strip(&#34;\n&#34;),
                         f&#34;SHA512 (file) = {sha512(message.encode()).hexdigest()}&#34;)

    def test_touch(self):
        self.computer.run_command(&#34;touch&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;touch&#34;, [&#34;--help&#34;], True)

        touch_result = self.computer.run_command(&#34;touch&#34;, [&#34;testfile&#34;], True)
        expected_touch_result = Result(success=True)

        # We should double check that the file exists in our home directory
        self.assertIn(&#34;testfile&#34;, self.computer.run_command(&#34;ls&#34;, [], True).data)

        self.assertEqual(touch_result, expected_touch_result)

    def test_uname(self):
        self.computer.run_command(&#34;uname&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;uname&#34;, [&#34;--help&#34;], True)

        # Test some misc uname configurations
        self.assertEqual(self.computer.run_command(&#34;uname&#34;, [], True).data.strip(&#34;\n&#34;), &#34;Linux&#34;)
        self.assertEqual(self.computer.run_command(&#34;uname&#34;, [&#34;-a&#34;], True).data.strip(&#34;\n&#34;),
                         f&#34;Linux {self.computer.hostname} 1.1 v1 x86_64 Blackhat/Linux&#34;)
        self.assertEqual(self.computer.run_command(&#34;uname&#34;, [&#34;-mns&#34;], True).data.strip(&#34;\n&#34;),
                         f&#34;Linux {self.computer.hostname} x86_64 &#34;)
        self.assertEqual(self.computer.run_command(&#34;uname&#34;, [&#34;-op&#34;, &#34;-i&#34;], True).data.strip(&#34;\n&#34;),
                         &#34;unknown unknown Blackhat/Linux &#34;)

    def test_unset(self):
        self.computer.run_command(&#34;unset&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;unset&#34;, [&#34;--help&#34;], True)

        # Lets get a baseline for the env before-hand
        env_result = self.computer.run_command(&#34;printenv&#34;, [], True).data.strip(&#34;\n&#34;)
        self.assertEqual(env_result, &#34;PATH=/usr/bin:/bin\nHOME=/home/steve\nUSER=steve&#34;)

        self.computer.run_command(&#34;export&#34;, [&#34;BASH=/bin/bash&#34;], True)

        env_result = self.computer.run_command(&#34;printenv&#34;, [], True).data.strip(&#34;\n&#34;)
        self.assertEqual(env_result, &#34;PATH=/usr/bin:/bin\nHOME=/home/steve\nUSER=steve\nBASH=/bin/bash&#34;)

        self.computer.run_command(&#34;unset&#34;, [&#34;BASH&#34;], True)
        env_result = self.computer.run_command(&#34;printenv&#34;, [], True).data.strip(&#34;\n&#34;)
        self.assertEqual(env_result, &#34;PATH=/usr/bin:/bin\nHOME=/home/steve\nUSER=steve&#34;)

    def test_uptime(self):
        self.computer.run_command(&#34;uptime&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;uptime&#34;, [&#34;--help&#34;], True)

        # Make sure it doesn&#39;t crash
        uptime_result = self.computer.run_command(&#34;uptime&#34;, [], True).data.strip(&#34;\n&#34;)
        # TODO: See if there&#39;s a better way to fix this without wasting 5 seconds
        self.assertEqual(uptime_result, &#34;uptime: 0:00:00&#34;)

        sleep(5)
        uptime_result = self.computer.run_command(&#34;uptime&#34;, [], True).data.strip(&#34;\n&#34;)
        self.assertEqual(uptime_result, &#34;uptime: 0:00:05&#34;)

        uptime_result = self.computer.run_command(&#34;uptime&#34;, [&#34;-p&#34;], True).data.strip(&#34;\n&#34;)
        self.assertEqual(uptime_result, &#34;up 0 minutes&#34;)

        now = datetime.datetime.now().strftime(&#34;%Y-%m-%d %H:%M:%S&#34;)
        uptime_result = self.computer.run_command(&#34;uptime&#34;, [&#34;-s&#34;], True).data.strip(&#34;\n&#34;)

        # I&#39;m going to strip out the seconds because different speed test runners can take different amount of times
        # to run

        now = &#34;:&#34;.join(now.split(&#34;:&#34;)[:-1])
        uptime_result = &#34;:&#34;.join(uptime_result.split(&#34;:&#34;)[:-1])

        self.assertEqual(now, uptime_result)

    def test_users(self):
        self.computer.run_command(&#34;users&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;users&#34;, [&#34;--help&#34;], True)

        # One session = only one user
        users_result = self.computer.run_command(&#34;users&#34;, [], True).data.strip(&#34;\n&#34;)
        self.assertEqual(users_result, &#34;steve &#34;)

        # Add new sessions then test
        self.computer.sessions.append(Session(0, self.computer.fs.files, self.computer.sessions[-1].id + 1))
        users_result = self.computer.run_command(&#34;users&#34;, [], True).data.strip(&#34;\n&#34;)
        self.assertEqual(users_result, &#34;steve root &#34;)

        self.computer.sessions.append(Session(1000, self.computer.fs.files, self.computer.sessions[-1].id + 1))
        users_result = self.computer.run_command(&#34;users&#34;, [], True).data.strip(&#34;\n&#34;)
        self.assertEqual(users_result, &#34;steve root steve &#34;)

    def test_wc(self):
        self.computer.run_command(&#34;wc&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;wc&#34;, [&#34;--help&#34;], True)

        message = &#34;hello!&#34;
        message_len = len(message + &#34;\n&#34;)

        self.computer.run_command(&#34;touch&#34;, [&#34;file&#34;], True)
        # We&#39;re writing with a new line to replicate what `echo hello! &gt; file` would do
        self.computer.fs.find(&#34;/home/steve/file&#34;).data.write(message + &#34;\n&#34;, self.computer)

        wc_result = self.computer.run_command(&#34;wc&#34;, [&#34;file&#34;], True).data.strip(&#34;\n&#34;)

        wc_split_results = wc_result.split(&#34; &#34;)
        while &#34;&#34; in wc_split_results:
            wc_split_results.remove(&#34;&#34;)

        total_new_line_count, total_word_count, total_byte_count = wc_split_results[0], wc_split_results[1], \
                                                                   wc_split_results[2]

        self.assertEqual(int(total_byte_count), message_len)
        self.assertEqual(int(total_new_line_count), 1)
        self.assertEqual(int(total_word_count), 1)

        wc_result = self.computer.run_command(&#34;wc&#34;, [&#34;file&#34;, &#34;-c&#34;], True).data.strip(&#34;\n&#34;)

        wc_split_results = wc_result.split(&#34; &#34;)
        while &#34;&#34; in wc_split_results:
            wc_split_results.remove(&#34;&#34;)

        total_byte_count = wc_split_results[0]

        self.assertEqual(int(total_byte_count), message_len)

        wc_result = self.computer.run_command(&#34;wc&#34;, [&#34;file&#34;, &#34;-m&#34;], True).data.strip(&#34;\n&#34;)

        wc_split_results = wc_result.split(&#34; &#34;)
        while &#34;&#34; in wc_split_results:
            wc_split_results.remove(&#34;&#34;)

        total_byte_count = wc_split_results[0]

        self.assertEqual(int(total_byte_count), message_len)

    def test_who(self):
        self.computer.run_command(&#34;who&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;who&#34;, [&#34;--help&#34;], True)

        who_result = self.computer.run_command(&#34;who&#34;, [], True).data.strip(&#34;\n&#34;)
        self.assertEqual(who_result, &#34;steve\tpts/0&#34;)

    def test_whoami(self):
        self.computer.run_command(&#34;whoami&#34;, [&#34;--version&#34;], True)
        self.computer.run_command(&#34;whoami&#34;, [&#34;--help&#34;], True)

        whoami_result = self.computer.run_command(&#34;whoami&#34;, [], True).data.strip(&#34;\n&#34;)

        self.assertEqual(whoami_result, &#34;steve&#34;)</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>unittest.case.TestCase</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="blackhat.tests.test_binaries.TestIncludedBinaries.setUp"><code class="name flex">
<span>def <span class="ident">setUp</span></span>(<span>self) ‑> None</span>
</code></dt>
<dd>
<div class="desc"><p>Hook method for setting up the test fixture before exercising it.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def setUp(self) -&gt; None:
    self.computer = init()</code></pre>
</details>
</dd>
<dt id="blackhat.tests.test_binaries.TestIncludedBinaries.test_add_user"><code class="name flex">
<span>def <span class="ident">test_add_user</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_add_user(self):
    self.computer.run_command(&#34;adduser&#34;, [&#34;--version&#34;], True)
    self.computer.run_command(&#34;adduser&#34;, [&#34;--help&#34;], True)

    fail_bc_not_root_result = self.computer.run_command(&#34;adduser&#34;, [&#34;testuser&#34;, &#34;-p&#34; &#34;password&#34;, &#34;-n&#34;], True)
    expected_fail_bc_not_root_result = Result(success=False, message=ResultMessages.NOT_ALLOWED,
                                              data=&#34;adduser: Only root can add new users!\n&#34;)

    self.assertEqual(fail_bc_not_root_result, expected_fail_bc_not_root_result)

    self.computer.sessions.append(Session(0, self.computer.fs.files, self.computer.sessions[-1].id + 1))

    create_new_user_result = self.computer.run_command(&#34;adduser&#34;, [&#34;testuser&#34;, &#34;-p&#34; &#34;password&#34;, &#34;-n&#34;], True)
    expected_create_new_user_result = Result(success=True, message=None, data=None)
    create_duplicate_user_result = self.computer.run_command(&#34;adduser&#34;, [&#34;testuser&#34;, &#34;-p&#34; &#34;password&#34;, &#34;-n&#34;], True)
    expected_create_duplicate_user_result = Result(success=False, message=ResultMessages.ALREADY_EXISTS,
                                                   data=&#34;adduser: The user &#39;testuser&#39; already exists.\n&#34;)

    self.assertEqual(create_new_user_result, expected_create_new_user_result)
    self.assertEqual(create_duplicate_user_result, expected_create_duplicate_user_result)

    # Now confirm that the user was actually added
    get_user_result = self.computer.get_user(username=&#34;testuser&#34;)
    expected_get_user_result = Result(success=True, message=None,
                                      data=User(1001, &#34;testuser&#34;, md5(&#34;password&#34;.encode()).hexdigest()))
    self.assertEqual(get_user_result, expected_get_user_result)</code></pre>
</details>
</dd>
<dt id="blackhat.tests.test_binaries.TestIncludedBinaries.test_base32"><code class="name flex">
<span>def <span class="ident">test_base32</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_base32(self):
    self.computer.run_command(&#34;base32&#34;, [&#34;--version&#34;], True)
    self.computer.run_command(&#34;base32&#34;, [&#34;--help&#34;], True)

    message = &#34;Hello!&#34;

    self.computer.run_command(&#34;touch&#34;, [&#34;file&#34;], True)
    # We&#39;re writing with a new line to replicate what `echo hello! &gt; file` would do
    self.computer.fs.find(&#34;/home/steve/file&#34;).data.write(message + &#34;\n&#34;, self.computer)

    base32_result = self.computer.run_command(&#34;base32&#34;, [&#34;file&#34;], True).data.replace(&#34;\n&#34;, &#34;&#34;).split(&#34; &#34;)[1]
    self.assertEqual(b32decode(base32_result).decode().strip(&#34;\n&#34;), message)</code></pre>
</details>
</dd>
<dt id="blackhat.tests.test_binaries.TestIncludedBinaries.test_base64"><code class="name flex">
<span>def <span class="ident">test_base64</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_base64(self):
    self.computer.run_command(&#34;base64&#34;, [&#34;--version&#34;], True)
    self.computer.run_command(&#34;base64&#34;, [&#34;--help&#34;], True)

    message = &#34;Hello!&#34;

    self.computer.run_command(&#34;touch&#34;, [&#34;file&#34;], True)
    # We&#39;re writing with a new line to replicate what `echo hello! &gt; file` would do
    self.computer.fs.find(&#34;/home/steve/file&#34;).data.write(message + &#34;\n&#34;, self.computer)

    base64_result = self.computer.run_command(&#34;base64&#34;, [&#34;file&#34;], True).data.replace(&#34;\n&#34;, &#34;&#34;).split(&#34; &#34;)[1]
    self.assertEqual(b64decode(base64_result).decode().strip(&#34;\n&#34;), message)</code></pre>
</details>
</dd>
<dt id="blackhat.tests.test_binaries.TestIncludedBinaries.test_cd"><code class="name flex">
<span>def <span class="ident">test_cd</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_cd(self):
    self.computer.run_command(&#34;cd&#34;, [&#34;--version&#34;], True)
    self.computer.run_command(&#34;cd&#34;, [&#34;--help&#34;], True)

    self.assertEqual(self.computer.sys_getcwd().pwd(), &#34;/home/steve&#34;)
    self.computer.run_command(&#34;cd&#34;, [&#34;..&#34;], True)
    self.assertEqual(self.computer.sys_getcwd().pwd(), &#34;/home&#34;)
    self.computer.run_command(&#34;cd&#34;, [&#34;...&#34;], True)
    self.assertEqual(self.computer.sys_getcwd().pwd(), &#34;/&#34;)
    self.computer.run_command(&#34;cd&#34;, [&#34;/etc/skel/Desktop&#34;], True)
    self.assertEqual(self.computer.sys_getcwd().pwd(), &#34;/etc/skel/Desktop&#34;)
    self.computer.run_command(&#34;cd&#34;, [&#34;~&#34;], True)
    self.assertEqual(self.computer.sys_getcwd().pwd(), &#34;/home/steve&#34;)</code></pre>
</details>
</dd>
<dt id="blackhat.tests.test_binaries.TestIncludedBinaries.test_chown"><code class="name flex">
<span>def <span class="ident">test_chown</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_chown(self):
    self.computer.run_command(&#34;chown&#34;, [&#34;--version&#34;], True)
    self.computer.run_command(&#34;chown&#34;, [&#34;--help&#34;], True)

    self.computer.run_command(&#34;touch&#34;, [&#34;testfile&#34;], True)

    self.assertEqual(self.computer.fs.find(&#34;/home/steve/testfile&#34;).data.owner, 1000)
    self.assertEqual(self.computer.fs.find(&#34;/home/steve/testfile&#34;).data.group_owner, 1000)

    self.computer.run_command(&#34;chown&#34;, [&#34;root:root&#34;, &#34;testfile&#34;], True)
    self.assertEqual(self.computer.fs.find(&#34;/home/steve/testfile&#34;).data.owner, 0)
    self.assertEqual(self.computer.fs.find(&#34;/home/steve/testfile&#34;).data.group_owner, 0)</code></pre>
</details>
</dd>
<dt id="blackhat.tests.test_binaries.TestIncludedBinaries.test_clear"><code class="name flex">
<span>def <span class="ident">test_clear</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_clear(self):
    self.computer.run_command(&#34;clear&#34;, [&#34;--version&#34;], True)
    self.computer.run_command(&#34;clear&#34;, [&#34;--help&#34;], True)

    self.computer.run_command(&#34;clear&#34;, [], True)</code></pre>
</details>
</dd>
<dt id="blackhat.tests.test_binaries.TestIncludedBinaries.test_commands"><code class="name flex">
<span>def <span class="ident">test_commands</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_commands(self):
    self.computer.run_command(&#34;commands&#34;, [&#34;--version&#34;], True)
    self.computer.run_command(&#34;commands&#34;, [&#34;--help&#34;], True)

    commands_result = self.computer.run_command(&#34;commands&#34;, [], True).data.strip(&#34;\n&#34;)
    self.assertIn(&#34;ls&#34;, commands_result)

    # Now lets remove ls from /bin (it shouldn&#39;t show up in commands)
    # We need root permissions
    self.computer.sessions.append(Session(0, self.computer.fs.files, self.computer.sessions[-1].id + 1))
    move_result = self.computer.run_command(&#34;mv&#34;, [&#34;/bin/ls&#34;, &#34;/tmp&#34;], True)
    self.assertTrue(move_result.success)

    commands_result = self.computer.run_command(&#34;commands&#34;, [], True).data.strip(&#34;\n&#34;)
    self.assertNotIn(&#34;ls&#34;, commands_result)</code></pre>
</details>
</dd>
<dt id="blackhat.tests.test_binaries.TestIncludedBinaries.test_date"><code class="name flex">
<span>def <span class="ident">test_date</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_date(self):
    self.computer.run_command(&#34;date&#34;, [&#34;--version&#34;], True)
    self.computer.run_command(&#34;date&#34;, [&#34;--help&#34;], True)

    date_result = self.computer.run_command(&#34;date&#34;, [], True)

    local_timezone = datetime.datetime.now(datetime.timezone.utc).astimezone().tzinfo
    time_first = datetime.datetime.now().strftime(&#39;%a %b %d %I:%M:%S %p&#39;)
    time_second = datetime.datetime.now().strftime(&#39;%Y&#39;)

    expected_result = f&#34;{time_first} {local_timezone} {time_second}&#34;

    self.assertEqual(date_result.data.strip(&#34;\n&#34;), expected_result)</code></pre>
</details>
</dd>
<dt id="blackhat.tests.test_binaries.TestIncludedBinaries.test_echo"><code class="name flex">
<span>def <span class="ident">test_echo</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_echo(self):
    self.computer.run_command(&#34;echo&#34;, [&#34;--version&#34;], True)
    self.computer.run_command(&#34;echo&#34;, [&#34;--help&#34;], True)

    echo_result = self.computer.run_command(&#34;echo&#34;, [&#34;hello!&#34;], True)
    self.assertEqual(echo_result.data, &#34;hello!\n&#34;)

    # Test -e flag
    echo_e_flag_result = self.computer.run_command(&#34;echo&#34;, [&#34;-e&#34;, &#34;hello\n\tworld!&#34;], True)
    self.assertEqual(echo_e_flag_result.data, &#34;hello\n\tworld!\n&#34;)

    # Test -n flag
    echo_n_flag_result = self.computer.run_command(&#34;echo&#34;, [&#34;-n&#34;, &#34;hello world!\n&#34;], True)
    self.assertEqual(echo_n_flag_result.data, &#34;hello world!\n&#34;)</code></pre>
</details>
</dd>
<dt id="blackhat.tests.test_binaries.TestIncludedBinaries.test_env"><code class="name flex">
<span>def <span class="ident">test_env</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_env(self):
    self.computer.run_command(&#34;env&#34;, [&#34;--version&#34;], True)
    self.computer.run_command(&#34;env&#34;, [&#34;--help&#34;], True)

    env_result = self.computer.run_command(&#34;env&#34;, [], True).data.strip(&#34;\n&#34;)
    print(f&#34;ENVRESULT: {env_result}&#34;)
    self.assertEqual(env_result, &#34;PATH=/usr/bin:/bin\nHOME=/home/steve\nUSER=steve&#34;)</code></pre>
</details>
</dd>
<dt id="blackhat.tests.test_binaries.TestIncludedBinaries.test_export"><code class="name flex">
<span>def <span class="ident">test_export</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_export(self):
    self.computer.run_command(&#34;export&#34;, [&#34;--version&#34;], True)
    self.computer.run_command(&#34;export&#34;, [&#34;--help&#34;], True)

    # Lets get a baseline for the env before-hand
    env_result = self.computer.run_command(&#34;printenv&#34;, [], True).data.strip(&#34;\n&#34;)
    self.assertEqual(env_result, &#34;PATH=/usr/bin:/bin\nHOME=/home/steve\nUSER=steve&#34;)

    self.computer.run_command(&#34;export&#34;, [&#34;BASH=/bin/bash&#34;], True)

    env_result = self.computer.run_command(&#34;printenv&#34;, [], True).data.strip(&#34;\n&#34;)
    self.assertEqual(env_result, &#34;PATH=/usr/bin:/bin\nHOME=/home/steve\nUSER=steve\nBASH=/bin/bash&#34;)</code></pre>
</details>
</dd>
<dt id="blackhat.tests.test_binaries.TestIncludedBinaries.test_hostname"><code class="name flex">
<span>def <span class="ident">test_hostname</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_hostname(self):
    self.computer.run_command(&#34;hostname&#34;, [&#34;--version&#34;], True)
    self.computer.run_command(&#34;hostname&#34;, [&#34;--help&#34;], True)

    # We want to try to set the hostname without root permission (should fail)
    set_hostname_result = self.computer.run_command(&#34;hostname&#34;, [&#34;localhost&#34;], True)
    expected_set_hostname_result = Result(success=False,
                                          data=&#34;hostname: you must be root to change the host name&#34;)

    set_hostname_result.data = set_hostname_result.data.strip(&#34;\n&#34;)

    self.assertEqual(set_hostname_result, expected_set_hostname_result)

    # Make sure it failed
    get_hostname_result = self.computer.run_command(&#34;hostname&#34;, [], True)

    self.assertNotEqual(get_hostname_result.data, &#34;localhost&#34;)

    # Switch to root then change hostname
    self.computer.sessions.append(Session(0, self.computer.fs.files, self.computer.sessions[-1].id + 1))

    self.computer.run_command(&#34;hostname&#34;, [&#34;localhost&#34;], True)
    get_hostname_result = self.computer.run_command(&#34;hostname&#34;, [], True)

    self.assertEqual(get_hostname_result.data.strip(&#34;\n&#34;), &#34;localhost&#34;)</code></pre>
</details>
</dd>
<dt id="blackhat.tests.test_binaries.TestIncludedBinaries.test_id"><code class="name flex">
<span>def <span class="ident">test_id</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_id(self):
    self.computer.run_command(&#34;id&#34;, [&#34;--version&#34;], True)
    self.computer.run_command(&#34;id&#34;, [&#34;--help&#34;], True)

    self_id_result = self.computer.run_command(&#34;id&#34;, [], True).data.strip(&#34;\n&#34;)
    expected_self_id_result = &#34;uid=1000(steve) gid=1000(steve) &#34;
    self.assertEqual(self_id_result, expected_self_id_result)

    root_id_result = self.computer.run_command(&#34;id&#34;, [&#34;root&#34;], True).data.strip(&#34;\n&#34;)
    root_id_by_uid_result = self.computer.run_command(&#34;id&#34;, [&#34;0&#34;], True).data.strip(&#34;\n&#34;)
    expected_root_result = &#34;uid=0(root) gid=0(root) &#34;
    self.assertEqual(root_id_result, expected_root_result)
    self.assertEqual(root_id_by_uid_result, expected_root_result)

    # Check the flags
    id_result = self.computer.run_command(&#34;id&#34;, [&#34;-g&#34;], True).data.strip(&#34;\n&#34;)
    self.assertEqual(id_result, &#34;1000&#34;)

    id_result = self.computer.run_command(&#34;id&#34;, [&#34;-G&#34;], True).data.strip(&#34;\n&#34;)
    self.assertEqual(id_result, &#34;1000&#34;)

    id_result = self.computer.run_command(&#34;id&#34;, [&#34;-n&#34;], True).data.strip(&#34;\n&#34;)
    self.assertEqual(id_result, &#34;steve&#34;)</code></pre>
</details>
</dd>
<dt id="blackhat.tests.test_binaries.TestIncludedBinaries.test_ls"><code class="name flex">
<span>def <span class="ident">test_ls</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_ls(self):
    import re
    self.computer.run_command(&#34;ls&#34;, [&#34;--version&#34;], True)
    self.computer.run_command(&#34;ls&#34;, [&#34;--help&#34;], True)

    # In the user&#39;s home directory, The files should be: Desktop Documents Downloads Music Pictures Public Templates Videos
    ls_result = self.computer.run_command(&#34;ls&#34;, [&#34;--no-color&#34;], True)
    expected_ls_result = Result(success=True, message=None,
                                data=&#34;Desktop Documents Downloads Music Pictures Public Templates Videos &#34;)

    ls_result.data = ls_result.data.strip(&#34;\n&#34;)

    print(ls_result)
    print(expected_ls_result)

    color_filter = re.compile(r&#39;\x1b[^m]*m&#39;)
    stripped_color = color_filter.sub(&#39;&#39;, ls_result.data)

    self.assertEqual(stripped_color, expected_ls_result.data)
    # Make sure .shellrc isn&#39;t there (as -a isn&#39;t specified)
    self.assertNotIn(&#34;.shellrc&#34;, ls_result.data)

    # Test -a flag (show hidden files)
    ls_result = self.computer.run_command(&#34;ls&#34;, [&#34;--no-color&#34;, &#34;-a&#34;], True)
    self.assertIn(&#34;.shellrc&#34;, ls_result.data)

    # Make sure -l flag works
    ls_result = self.computer.run_command(&#34;ls&#34;, [&#34;--no-color&#34;, &#34;-l&#34;], True)
    self.assertIn(&#34;steve&#34;, ls_result.data)</code></pre>
</details>
</dd>
<dt id="blackhat.tests.test_binaries.TestIncludedBinaries.test_md5sum"><code class="name flex">
<span>def <span class="ident">test_md5sum</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_md5sum(self):
    self.computer.run_command(&#34;md5sum&#34;, [&#34;--version&#34;], True)
    self.computer.run_command(&#34;md5sum&#34;, [&#34;--help&#34;], True)

    message = &#34;hello!&#34;

    self.computer.run_command(&#34;touch&#34;, [&#34;file&#34;], True)
    # We&#39;re writing with a new line to replicate what `echo hello! &gt; file` would do
    self.computer.fs.find(&#34;/home/steve/file&#34;).data.write(message + &#34;\n&#34;, self.computer)

    self.assertIn(md5((message + &#34;\n&#34;).encode()).hexdigest(),
                  self.computer.run_command(&#34;md5sum&#34;, [&#34;file&#34;], True).data.strip(&#34;\n&#34;))
    self.assertIn(md5(message.encode()).hexdigest(),
                  self.computer.run_command(&#34;md5sum&#34;, [&#34;file&#34;, &#34;-z&#34;], True).data.strip(&#34;\n&#34;))
    self.assertEqual(self.computer.run_command(&#34;md5sum&#34;, [&#34;file&#34;, &#34;-z&#34;, &#34;--tag&#34;], True).data.strip(&#34;\n&#34;),
                     f&#34;MD5 (file) = {md5(message.encode()).hexdigest()}&#34;)</code></pre>
</details>
</dd>
<dt id="blackhat.tests.test_binaries.TestIncludedBinaries.test_mv"><code class="name flex">
<span>def <span class="ident">test_mv</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_mv(self):
    self.computer.run_command(&#34;mv&#34;, [&#34;--version&#34;], True)
    self.computer.run_command(&#34;mv&#34;, [&#34;--help&#34;], True)

    # Make sure /bin/pwd exists
    find_pwd = self.computer.fs.find(&#34;/bin/pwd&#34;)
    self.assertTrue(find_pwd.success)

    # Make sure permissions work when moving
    self.assertFalse(self.computer.run_command(&#34;mv&#34;, [&#34;/bin/pwd&#34;, &#34;/tmp&#34;], True).success)

    # Make sure /bin/pwd still exists
    find_pwd = self.computer.fs.find(&#34;/bin/pwd&#34;)
    self.assertTrue(find_pwd.success)

    # Make sure /tmp/pwd DOESN&#39;T exists
    find_pwd = self.computer.fs.find(&#34;/tmp/pwd&#34;)
    self.assertFalse(find_pwd.success)

    # Root perms!
    self.computer.sessions.append(Session(0, self.computer.fs.files, self.computer.sessions[-1].id + 1))

    self.computer.run_command(&#34;mv&#34;, [&#34;/bin/pwd&#34;, &#34;/tmp&#34;], True)

    # Make sure /bin/pwd DOESN&#39;T exists
    find_pwd = self.computer.fs.find(&#34;/bin/pwd&#34;)
    self.assertFalse(find_pwd.success)

    # Make sure /tmp/pwd exists
    find_pwd = self.computer.fs.find(&#34;/tmp/pwd&#34;)
    self.assertTrue(find_pwd.success)</code></pre>
</details>
</dd>
<dt id="blackhat.tests.test_binaries.TestIncludedBinaries.test_printenv"><code class="name flex">
<span>def <span class="ident">test_printenv</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_printenv(self):
    self.computer.run_command(&#34;printenv&#34;, [&#34;--version&#34;], True)
    self.computer.run_command(&#34;printenv&#34;, [&#34;--help&#34;], True)

    env_result = self.computer.run_command(&#34;printenv&#34;, [], True).data.strip(&#34;\n&#34;)
    self.assertEqual(env_result, &#34;PATH=/usr/bin:/bin\nHOME=/home/steve\nUSER=steve&#34;)</code></pre>
</details>
</dd>
<dt id="blackhat.tests.test_binaries.TestIncludedBinaries.test_pwd"><code class="name flex">
<span>def <span class="ident">test_pwd</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_pwd(self):
    self.computer.run_command(&#34;pwd&#34;, [&#34;--version&#34;], True)
    self.computer.run_command(&#34;pwd&#34;, [&#34;--help&#34;], True)

    pwd_result = self.computer.run_command(&#34;pwd&#34;, [], True).data.strip(&#34;\n&#34;)

    self.assertEqual(&#34;/home/steve&#34;, pwd_result)</code></pre>
</details>
</dd>
<dt id="blackhat.tests.test_binaries.TestIncludedBinaries.test_sha1sum"><code class="name flex">
<span>def <span class="ident">test_sha1sum</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_sha1sum(self):
    self.computer.run_command(&#34;sha1sum&#34;, [&#34;--version&#34;], True)
    self.computer.run_command(&#34;sha1sum&#34;, [&#34;--help&#34;], True)

    message = &#34;hello!&#34;

    self.computer.run_command(&#34;touch&#34;, [&#34;file&#34;], True)
    # We&#39;re writing with a new line to replicate what `echo hello! &gt; file` would do
    self.computer.fs.find(&#34;/home/steve/file&#34;).data.write(message + &#34;\n&#34;, self.computer)

    self.assertIn(sha1((message + &#34;\n&#34;).encode()).hexdigest(),
                  self.computer.run_command(&#34;sha1sum&#34;, [&#34;file&#34;], True).data.strip(&#34;\n&#34;))
    self.assertIn(sha1(message.encode()).hexdigest(),
                  self.computer.run_command(&#34;sha1sum&#34;, [&#34;file&#34;, &#34;-z&#34;], True).data.strip(&#34;\n&#34;))
    self.assertEqual(self.computer.run_command(&#34;sha1sum&#34;, [&#34;file&#34;, &#34;-z&#34;, &#34;--tag&#34;], True).data.strip(&#34;\n&#34;),
                     f&#34;SHA1 (file) = {sha1(message.encode()).hexdigest()}&#34;)</code></pre>
</details>
</dd>
<dt id="blackhat.tests.test_binaries.TestIncludedBinaries.test_sha224sum"><code class="name flex">
<span>def <span class="ident">test_sha224sum</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_sha224sum(self):
    self.computer.run_command(&#34;sha224sum&#34;, [&#34;--version&#34;], True)
    self.computer.run_command(&#34;sha224sum&#34;, [&#34;--help&#34;], True)

    message = &#34;hello!&#34;

    self.computer.run_command(&#34;touch&#34;, [&#34;file&#34;], True)
    # We&#39;re writing with a new line to replicate what `echo hello! &gt; file` would do
    self.computer.fs.find(&#34;/home/steve/file&#34;).data.write(message + &#34;\n&#34;, self.computer)

    self.assertIn(sha224((message + &#34;\n&#34;).encode()).hexdigest(),
                  self.computer.run_command(&#34;sha224sum&#34;, [&#34;file&#34;], True).data.strip(&#34;\n&#34;))
    self.assertIn(sha224(message.encode()).hexdigest(),
                  self.computer.run_command(&#34;sha224sum&#34;, [&#34;file&#34;, &#34;-z&#34;], True).data.strip(&#34;\n&#34;))
    self.assertEqual(self.computer.run_command(&#34;sha224sum&#34;, [&#34;file&#34;, &#34;-z&#34;, &#34;--tag&#34;], True).data.strip(&#34;\n&#34;),
                     f&#34;SHA224 (file) = {sha224(message.encode()).hexdigest()}&#34;)</code></pre>
</details>
</dd>
<dt id="blackhat.tests.test_binaries.TestIncludedBinaries.test_sha256sum"><code class="name flex">
<span>def <span class="ident">test_sha256sum</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_sha256sum(self):
    self.computer.run_command(&#34;sha256sum&#34;, [&#34;--version&#34;], True)
    self.computer.run_command(&#34;sha256sum&#34;, [&#34;--help&#34;], True)

    message = &#34;hello!&#34;

    self.computer.run_command(&#34;touch&#34;, [&#34;file&#34;], True)
    # We&#39;re writing with a new line to replicate what `echo hello! &gt; file` would do
    self.computer.fs.find(&#34;/home/steve/file&#34;).data.write(message + &#34;\n&#34;, self.computer)

    self.assertIn(sha256((message + &#34;\n&#34;).encode()).hexdigest(),
                  self.computer.run_command(&#34;sha256sum&#34;, [&#34;file&#34;], True).data.strip(&#34;\n&#34;))
    self.assertIn(sha256(message.encode()).hexdigest(),
                  self.computer.run_command(&#34;sha256sum&#34;, [&#34;file&#34;, &#34;-z&#34;], True).data.strip(&#34;\n&#34;))
    self.assertEqual(self.computer.run_command(&#34;sha256sum&#34;, [&#34;file&#34;, &#34;-z&#34;, &#34;--tag&#34;], True).data.strip(&#34;\n&#34;),
                     f&#34;SHA256 (file) = {sha256(message.encode()).hexdigest()}&#34;)</code></pre>
</details>
</dd>
<dt id="blackhat.tests.test_binaries.TestIncludedBinaries.test_sha384sum"><code class="name flex">
<span>def <span class="ident">test_sha384sum</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_sha384sum(self):
    self.computer.run_command(&#34;sha384sum&#34;, [&#34;--version&#34;], True)
    self.computer.run_command(&#34;sha384sum&#34;, [&#34;--help&#34;], True)

    message = &#34;hello!&#34;

    self.computer.run_command(&#34;touch&#34;, [&#34;file&#34;], True)
    # We&#39;re writing with a new line to replicate what `echo hello! &gt; file` would do
    self.computer.fs.find(&#34;/home/steve/file&#34;).data.write(message + &#34;\n&#34;, self.computer)

    self.assertIn(sha384((message + &#34;\n&#34;).encode()).hexdigest(),
                  self.computer.run_command(&#34;sha384sum&#34;, [&#34;file&#34;], True).data.strip(&#34;\n&#34;))
    self.assertIn(sha384(message.encode()).hexdigest(),
                  self.computer.run_command(&#34;sha384sum&#34;, [&#34;file&#34;, &#34;-z&#34;], True).data.strip(&#34;\n&#34;))
    self.assertEqual(self.computer.run_command(&#34;sha384sum&#34;, [&#34;file&#34;, &#34;-z&#34;, &#34;--tag&#34;], True).data.strip(&#34;\n&#34;),
                     f&#34;SHA384 (file) = {sha384(message.encode()).hexdigest()}&#34;)</code></pre>
</details>
</dd>
<dt id="blackhat.tests.test_binaries.TestIncludedBinaries.test_sha512sum"><code class="name flex">
<span>def <span class="ident">test_sha512sum</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_sha512sum(self):
    self.computer.run_command(&#34;sha512sum&#34;, [&#34;--version&#34;], True)
    self.computer.run_command(&#34;sha512sum&#34;, [&#34;--help&#34;], True)

    message = &#34;hello!&#34;

    self.computer.run_command(&#34;touch&#34;, [&#34;file&#34;], True)
    # We&#39;re writing with a new line to replicate what `echo hello! &gt; file` would do
    self.computer.fs.find(&#34;/home/steve/file&#34;).data.write(message + &#34;\n&#34;, self.computer)

    self.assertIn(sha512((message + &#34;\n&#34;).encode()).hexdigest(),
                  self.computer.run_command(&#34;sha512sum&#34;, [&#34;file&#34;], True).data.strip(&#34;\n&#34;))
    self.assertIn(sha512(message.encode()).hexdigest(),
                  self.computer.run_command(&#34;sha512sum&#34;, [&#34;file&#34;, &#34;-z&#34;], True).data.strip(&#34;\n&#34;))
    self.assertEqual(self.computer.run_command(&#34;sha512sum&#34;, [&#34;file&#34;, &#34;-z&#34;, &#34;--tag&#34;], True).data.strip(&#34;\n&#34;),
                     f&#34;SHA512 (file) = {sha512(message.encode()).hexdigest()}&#34;)</code></pre>
</details>
</dd>
<dt id="blackhat.tests.test_binaries.TestIncludedBinaries.test_touch"><code class="name flex">
<span>def <span class="ident">test_touch</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_touch(self):
    self.computer.run_command(&#34;touch&#34;, [&#34;--version&#34;], True)
    self.computer.run_command(&#34;touch&#34;, [&#34;--help&#34;], True)

    touch_result = self.computer.run_command(&#34;touch&#34;, [&#34;testfile&#34;], True)
    expected_touch_result = Result(success=True)

    # We should double check that the file exists in our home directory
    self.assertIn(&#34;testfile&#34;, self.computer.run_command(&#34;ls&#34;, [], True).data)

    self.assertEqual(touch_result, expected_touch_result)</code></pre>
</details>
</dd>
<dt id="blackhat.tests.test_binaries.TestIncludedBinaries.test_uname"><code class="name flex">
<span>def <span class="ident">test_uname</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_uname(self):
    self.computer.run_command(&#34;uname&#34;, [&#34;--version&#34;], True)
    self.computer.run_command(&#34;uname&#34;, [&#34;--help&#34;], True)

    # Test some misc uname configurations
    self.assertEqual(self.computer.run_command(&#34;uname&#34;, [], True).data.strip(&#34;\n&#34;), &#34;Linux&#34;)
    self.assertEqual(self.computer.run_command(&#34;uname&#34;, [&#34;-a&#34;], True).data.strip(&#34;\n&#34;),
                     f&#34;Linux {self.computer.hostname} 1.1 v1 x86_64 Blackhat/Linux&#34;)
    self.assertEqual(self.computer.run_command(&#34;uname&#34;, [&#34;-mns&#34;], True).data.strip(&#34;\n&#34;),
                     f&#34;Linux {self.computer.hostname} x86_64 &#34;)
    self.assertEqual(self.computer.run_command(&#34;uname&#34;, [&#34;-op&#34;, &#34;-i&#34;], True).data.strip(&#34;\n&#34;),
                     &#34;unknown unknown Blackhat/Linux &#34;)</code></pre>
</details>
</dd>
<dt id="blackhat.tests.test_binaries.TestIncludedBinaries.test_unset"><code class="name flex">
<span>def <span class="ident">test_unset</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_unset(self):
    self.computer.run_command(&#34;unset&#34;, [&#34;--version&#34;], True)
    self.computer.run_command(&#34;unset&#34;, [&#34;--help&#34;], True)

    # Lets get a baseline for the env before-hand
    env_result = self.computer.run_command(&#34;printenv&#34;, [], True).data.strip(&#34;\n&#34;)
    self.assertEqual(env_result, &#34;PATH=/usr/bin:/bin\nHOME=/home/steve\nUSER=steve&#34;)

    self.computer.run_command(&#34;export&#34;, [&#34;BASH=/bin/bash&#34;], True)

    env_result = self.computer.run_command(&#34;printenv&#34;, [], True).data.strip(&#34;\n&#34;)
    self.assertEqual(env_result, &#34;PATH=/usr/bin:/bin\nHOME=/home/steve\nUSER=steve\nBASH=/bin/bash&#34;)

    self.computer.run_command(&#34;unset&#34;, [&#34;BASH&#34;], True)
    env_result = self.computer.run_command(&#34;printenv&#34;, [], True).data.strip(&#34;\n&#34;)
    self.assertEqual(env_result, &#34;PATH=/usr/bin:/bin\nHOME=/home/steve\nUSER=steve&#34;)</code></pre>
</details>
</dd>
<dt id="blackhat.tests.test_binaries.TestIncludedBinaries.test_uptime"><code class="name flex">
<span>def <span class="ident">test_uptime</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_uptime(self):
    self.computer.run_command(&#34;uptime&#34;, [&#34;--version&#34;], True)
    self.computer.run_command(&#34;uptime&#34;, [&#34;--help&#34;], True)

    # Make sure it doesn&#39;t crash
    uptime_result = self.computer.run_command(&#34;uptime&#34;, [], True).data.strip(&#34;\n&#34;)
    # TODO: See if there&#39;s a better way to fix this without wasting 5 seconds
    self.assertEqual(uptime_result, &#34;uptime: 0:00:00&#34;)

    sleep(5)
    uptime_result = self.computer.run_command(&#34;uptime&#34;, [], True).data.strip(&#34;\n&#34;)
    self.assertEqual(uptime_result, &#34;uptime: 0:00:05&#34;)

    uptime_result = self.computer.run_command(&#34;uptime&#34;, [&#34;-p&#34;], True).data.strip(&#34;\n&#34;)
    self.assertEqual(uptime_result, &#34;up 0 minutes&#34;)

    now = datetime.datetime.now().strftime(&#34;%Y-%m-%d %H:%M:%S&#34;)
    uptime_result = self.computer.run_command(&#34;uptime&#34;, [&#34;-s&#34;], True).data.strip(&#34;\n&#34;)

    # I&#39;m going to strip out the seconds because different speed test runners can take different amount of times
    # to run

    now = &#34;:&#34;.join(now.split(&#34;:&#34;)[:-1])
    uptime_result = &#34;:&#34;.join(uptime_result.split(&#34;:&#34;)[:-1])

    self.assertEqual(now, uptime_result)</code></pre>
</details>
</dd>
<dt id="blackhat.tests.test_binaries.TestIncludedBinaries.test_users"><code class="name flex">
<span>def <span class="ident">test_users</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_users(self):
    self.computer.run_command(&#34;users&#34;, [&#34;--version&#34;], True)
    self.computer.run_command(&#34;users&#34;, [&#34;--help&#34;], True)

    # One session = only one user
    users_result = self.computer.run_command(&#34;users&#34;, [], True).data.strip(&#34;\n&#34;)
    self.assertEqual(users_result, &#34;steve &#34;)

    # Add new sessions then test
    self.computer.sessions.append(Session(0, self.computer.fs.files, self.computer.sessions[-1].id + 1))
    users_result = self.computer.run_command(&#34;users&#34;, [], True).data.strip(&#34;\n&#34;)
    self.assertEqual(users_result, &#34;steve root &#34;)

    self.computer.sessions.append(Session(1000, self.computer.fs.files, self.computer.sessions[-1].id + 1))
    users_result = self.computer.run_command(&#34;users&#34;, [], True).data.strip(&#34;\n&#34;)
    self.assertEqual(users_result, &#34;steve root steve &#34;)</code></pre>
</details>
</dd>
<dt id="blackhat.tests.test_binaries.TestIncludedBinaries.test_wc"><code class="name flex">
<span>def <span class="ident">test_wc</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_wc(self):
    self.computer.run_command(&#34;wc&#34;, [&#34;--version&#34;], True)
    self.computer.run_command(&#34;wc&#34;, [&#34;--help&#34;], True)

    message = &#34;hello!&#34;
    message_len = len(message + &#34;\n&#34;)

    self.computer.run_command(&#34;touch&#34;, [&#34;file&#34;], True)
    # We&#39;re writing with a new line to replicate what `echo hello! &gt; file` would do
    self.computer.fs.find(&#34;/home/steve/file&#34;).data.write(message + &#34;\n&#34;, self.computer)

    wc_result = self.computer.run_command(&#34;wc&#34;, [&#34;file&#34;], True).data.strip(&#34;\n&#34;)

    wc_split_results = wc_result.split(&#34; &#34;)
    while &#34;&#34; in wc_split_results:
        wc_split_results.remove(&#34;&#34;)

    total_new_line_count, total_word_count, total_byte_count = wc_split_results[0], wc_split_results[1], \
                                                               wc_split_results[2]

    self.assertEqual(int(total_byte_count), message_len)
    self.assertEqual(int(total_new_line_count), 1)
    self.assertEqual(int(total_word_count), 1)

    wc_result = self.computer.run_command(&#34;wc&#34;, [&#34;file&#34;, &#34;-c&#34;], True).data.strip(&#34;\n&#34;)

    wc_split_results = wc_result.split(&#34; &#34;)
    while &#34;&#34; in wc_split_results:
        wc_split_results.remove(&#34;&#34;)

    total_byte_count = wc_split_results[0]

    self.assertEqual(int(total_byte_count), message_len)

    wc_result = self.computer.run_command(&#34;wc&#34;, [&#34;file&#34;, &#34;-m&#34;], True).data.strip(&#34;\n&#34;)

    wc_split_results = wc_result.split(&#34; &#34;)
    while &#34;&#34; in wc_split_results:
        wc_split_results.remove(&#34;&#34;)

    total_byte_count = wc_split_results[0]

    self.assertEqual(int(total_byte_count), message_len)</code></pre>
</details>
</dd>
<dt id="blackhat.tests.test_binaries.TestIncludedBinaries.test_who"><code class="name flex">
<span>def <span class="ident">test_who</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_who(self):
    self.computer.run_command(&#34;who&#34;, [&#34;--version&#34;], True)
    self.computer.run_command(&#34;who&#34;, [&#34;--help&#34;], True)

    who_result = self.computer.run_command(&#34;who&#34;, [], True).data.strip(&#34;\n&#34;)
    self.assertEqual(who_result, &#34;steve\tpts/0&#34;)</code></pre>
</details>
</dd>
<dt id="blackhat.tests.test_binaries.TestIncludedBinaries.test_whoami"><code class="name flex">
<span>def <span class="ident">test_whoami</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def test_whoami(self):
    self.computer.run_command(&#34;whoami&#34;, [&#34;--version&#34;], True)
    self.computer.run_command(&#34;whoami&#34;, [&#34;--help&#34;], True)

    whoami_result = self.computer.run_command(&#34;whoami&#34;, [], True).data.strip(&#34;\n&#34;)

    self.assertEqual(whoami_result, &#34;steve&#34;)</code></pre>
</details>
</dd>
</dl>
</dd>
<dt id="blackhat.tests.test_binaries.TestInstallableBinaries"><code class="flex name class">
<span>class <span class="ident">TestInstallableBinaries</span></span>
<span>(</span><span>methodName='runTest')</span>
</code></dt>
<dd>
<div class="desc"><p>These test cases test the functionality of the binaries that are NOT included with the system
(anything installable through apt)
This is anything in the client/blackhat/bin/installable folder</p>
<p>Create an instance of the class that will use the named test
method when executed. Raises a ValueError if the instance does
not have a method with the specified name.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class TestInstallableBinaries(unittest.TestCase):
    &#34;&#34;&#34;
    These test cases test the functionality of the binaries that are NOT included with the system
    (anything installable through apt)
    This is anything in the client/blackhat/bin/installable folder
    &#34;&#34;&#34;

    def setUp(self) -&gt; None:
        self.computer = init()</code></pre>
</details>
<h3>Ancestors</h3>
<ul class="hlist">
<li>unittest.case.TestCase</li>
</ul>
<h3>Methods</h3>
<dl>
<dt id="blackhat.tests.test_binaries.TestInstallableBinaries.setUp"><code class="name flex">
<span>def <span class="ident">setUp</span></span>(<span>self) ‑> None</span>
</code></dt>
<dd>
<div class="desc"><p>Hook method for setting up the test fixture before exercising it.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def setUp(self) -&gt; None:
    self.computer = init()</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="blackhat.tests" href="index.html">blackhat.tests</a></code></li>
</ul>
</li>
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="blackhat.tests.test_binaries.TestIncludedBinaries" href="#blackhat.tests.test_binaries.TestIncludedBinaries">TestIncludedBinaries</a></code></h4>
<ul class="two-column">
<li><code><a title="blackhat.tests.test_binaries.TestIncludedBinaries.setUp" href="#blackhat.tests.test_binaries.TestIncludedBinaries.setUp">setUp</a></code></li>
<li><code><a title="blackhat.tests.test_binaries.TestIncludedBinaries.test_add_user" href="#blackhat.tests.test_binaries.TestIncludedBinaries.test_add_user">test_add_user</a></code></li>
<li><code><a title="blackhat.tests.test_binaries.TestIncludedBinaries.test_base32" href="#blackhat.tests.test_binaries.TestIncludedBinaries.test_base32">test_base32</a></code></li>
<li><code><a title="blackhat.tests.test_binaries.TestIncludedBinaries.test_base64" href="#blackhat.tests.test_binaries.TestIncludedBinaries.test_base64">test_base64</a></code></li>
<li><code><a title="blackhat.tests.test_binaries.TestIncludedBinaries.test_cd" href="#blackhat.tests.test_binaries.TestIncludedBinaries.test_cd">test_cd</a></code></li>
<li><code><a title="blackhat.tests.test_binaries.TestIncludedBinaries.test_chown" href="#blackhat.tests.test_binaries.TestIncludedBinaries.test_chown">test_chown</a></code></li>
<li><code><a title="blackhat.tests.test_binaries.TestIncludedBinaries.test_clear" href="#blackhat.tests.test_binaries.TestIncludedBinaries.test_clear">test_clear</a></code></li>
<li><code><a title="blackhat.tests.test_binaries.TestIncludedBinaries.test_commands" href="#blackhat.tests.test_binaries.TestIncludedBinaries.test_commands">test_commands</a></code></li>
<li><code><a title="blackhat.tests.test_binaries.TestIncludedBinaries.test_date" href="#blackhat.tests.test_binaries.TestIncludedBinaries.test_date">test_date</a></code></li>
<li><code><a title="blackhat.tests.test_binaries.TestIncludedBinaries.test_echo" href="#blackhat.tests.test_binaries.TestIncludedBinaries.test_echo">test_echo</a></code></li>
<li><code><a title="blackhat.tests.test_binaries.TestIncludedBinaries.test_env" href="#blackhat.tests.test_binaries.TestIncludedBinaries.test_env">test_env</a></code></li>
<li><code><a title="blackhat.tests.test_binaries.TestIncludedBinaries.test_export" href="#blackhat.tests.test_binaries.TestIncludedBinaries.test_export">test_export</a></code></li>
<li><code><a title="blackhat.tests.test_binaries.TestIncludedBinaries.test_hostname" href="#blackhat.tests.test_binaries.TestIncludedBinaries.test_hostname">test_hostname</a></code></li>
<li><code><a title="blackhat.tests.test_binaries.TestIncludedBinaries.test_id" href="#blackhat.tests.test_binaries.TestIncludedBinaries.test_id">test_id</a></code></li>
<li><code><a title="blackhat.tests.test_binaries.TestIncludedBinaries.test_ls" href="#blackhat.tests.test_binaries.TestIncludedBinaries.test_ls">test_ls</a></code></li>
<li><code><a title="blackhat.tests.test_binaries.TestIncludedBinaries.test_md5sum" href="#blackhat.tests.test_binaries.TestIncludedBinaries.test_md5sum">test_md5sum</a></code></li>
<li><code><a title="blackhat.tests.test_binaries.TestIncludedBinaries.test_mv" href="#blackhat.tests.test_binaries.TestIncludedBinaries.test_mv">test_mv</a></code></li>
<li><code><a title="blackhat.tests.test_binaries.TestIncludedBinaries.test_printenv" href="#blackhat.tests.test_binaries.TestIncludedBinaries.test_printenv">test_printenv</a></code></li>
<li><code><a title="blackhat.tests.test_binaries.TestIncludedBinaries.test_pwd" href="#blackhat.tests.test_binaries.TestIncludedBinaries.test_pwd">test_pwd</a></code></li>
<li><code><a title="blackhat.tests.test_binaries.TestIncludedBinaries.test_sha1sum" href="#blackhat.tests.test_binaries.TestIncludedBinaries.test_sha1sum">test_sha1sum</a></code></li>
<li><code><a title="blackhat.tests.test_binaries.TestIncludedBinaries.test_sha224sum" href="#blackhat.tests.test_binaries.TestIncludedBinaries.test_sha224sum">test_sha224sum</a></code></li>
<li><code><a title="blackhat.tests.test_binaries.TestIncludedBinaries.test_sha256sum" href="#blackhat.tests.test_binaries.TestIncludedBinaries.test_sha256sum">test_sha256sum</a></code></li>
<li><code><a title="blackhat.tests.test_binaries.TestIncludedBinaries.test_sha384sum" href="#blackhat.tests.test_binaries.TestIncludedBinaries.test_sha384sum">test_sha384sum</a></code></li>
<li><code><a title="blackhat.tests.test_binaries.TestIncludedBinaries.test_sha512sum" href="#blackhat.tests.test_binaries.TestIncludedBinaries.test_sha512sum">test_sha512sum</a></code></li>
<li><code><a title="blackhat.tests.test_binaries.TestIncludedBinaries.test_touch" href="#blackhat.tests.test_binaries.TestIncludedBinaries.test_touch">test_touch</a></code></li>
<li><code><a title="blackhat.tests.test_binaries.TestIncludedBinaries.test_uname" href="#blackhat.tests.test_binaries.TestIncludedBinaries.test_uname">test_uname</a></code></li>
<li><code><a title="blackhat.tests.test_binaries.TestIncludedBinaries.test_unset" href="#blackhat.tests.test_binaries.TestIncludedBinaries.test_unset">test_unset</a></code></li>
<li><code><a title="blackhat.tests.test_binaries.TestIncludedBinaries.test_uptime" href="#blackhat.tests.test_binaries.TestIncludedBinaries.test_uptime">test_uptime</a></code></li>
<li><code><a title="blackhat.tests.test_binaries.TestIncludedBinaries.test_users" href="#blackhat.tests.test_binaries.TestIncludedBinaries.test_users">test_users</a></code></li>
<li><code><a title="blackhat.tests.test_binaries.TestIncludedBinaries.test_wc" href="#blackhat.tests.test_binaries.TestIncludedBinaries.test_wc">test_wc</a></code></li>
<li><code><a title="blackhat.tests.test_binaries.TestIncludedBinaries.test_who" href="#blackhat.tests.test_binaries.TestIncludedBinaries.test_who">test_who</a></code></li>
<li><code><a title="blackhat.tests.test_binaries.TestIncludedBinaries.test_whoami" href="#blackhat.tests.test_binaries.TestIncludedBinaries.test_whoami">test_whoami</a></code></li>
</ul>
</li>
<li>
<h4><code><a title="blackhat.tests.test_binaries.TestInstallableBinaries" href="#blackhat.tests.test_binaries.TestInstallableBinaries">TestInstallableBinaries</a></code></h4>
<ul class="">
<li><code><a title="blackhat.tests.test_binaries.TestInstallableBinaries.setUp" href="#blackhat.tests.test_binaries.TestInstallableBinaries.setUp">setUp</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html><style>body {
    background-color: #121212;
    color: white;
}

#sidebar {
    background-color: #242424;
}

#sidebar code {
    background-color: #282828 !important;
}


a {
    color: #8c00f7 !important;
}

.name {
    background-color: #1a1a1a !important;
}

code {
    background-color: #1a1a1a !important;
}

pre {
    background-color: #242424 !important;
    border-top: #242424 !important;
    border-bottom: #242424 !important;
    overflow-x: hidden !important;
}


h1:target, h2:target, h3:target, h4:target, h5:target, h6:target{
    background: #8c00f7
}

/* Modify color syntax highlighting */
.hljs {
    display: block;
    overflow-x: auto;
    padding: .5em;
    color: white !important;
    background: #f8f8f8
}

.hljs-comment,
.hljs-quote {
    color: #998;
    font-style: italic
}

.hljs-keyword,
.hljs-selector-tag,
.hljs-subst {
    color: dodgerblue !important;
    font-weight: 700
}

.hljs-literal,
.hljs-number,
.hljs-tag .hljs-attr,
.hljs-template-variable,
.hljs-variable {
    color: teal
}

.hljs-doctag,
.hljs-string {
    color: #d14
}

.hljs-section,
.hljs-selector-id,
.hljs-title {
    color: #900;
    font-weight: 700
}

.hljs-subst {
    font-weight: 400
}

.hljs-class .hljs-title,
.hljs-type {
    color: #458;
    font-weight: 700
}

.hljs-attribute,
.hljs-name,
.hljs-tag {
    color: navy;
    font-weight: 400
}

.hljs-link,
.hljs-regexp {
    color: #009926
}

.hljs-bullet,
.hljs-symbol {
    color: #990073
}

.hljs-built_in,
.hljs-builtin-name {
    color: #0086b3
}

.hljs-meta {
    color: #999;
    font-weight: 700
}

.hljs-deletion {
    background: #fdd
}

.hljs-addition {
    background: #dfd
}

.hljs-emphasis {
    font-style: italic
}

.hljs-strong {
    font-weight: 700
}

/* Custom scrollbar */
/* width */
::-webkit-scrollbar {
    width: 10px;
}

/* Track */
::-webkit-scrollbar-track {
    box-shadow: inset 0 0 2.5px grey;
    border-radius: 5px;
}

/* Handle */
::-webkit-scrollbar-thumb {
    background: gray;
    border-radius: 5px;
}

/* Handle on hover */
::-webkit-scrollbar-thumb:hover {
    background: #6b6b6b;
}

@media only screen and (max-width: 600px) {
    pre {
        overflow: scroll !important;
    }

    pre::-webkit-scrollbar {
        display: none !important;
    }
}</style>
