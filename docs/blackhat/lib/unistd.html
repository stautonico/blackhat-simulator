<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>blackhat.lib.unistd API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>blackhat.lib.unistd</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">from typing import Optional, Literal, Union

from .sys.socket import Socket
from ..fs import FSBaseObject
from ..helpers import Result, ResultMessages
from ..session import Session

computer: Optional[&#34;Computer&#34;] = None


def update(comp: &#34;Computer&#34;):
    &#34;&#34;&#34;
    Store a reference to the games current `Computer` object as a global variable so methods can reference it without
    requiring it as an argument
    
    Args:
        comp (:obj:`Computer`): The games current `Computer` object

    Returns:
        None
    &#34;&#34;&#34;
    global computer
    computer = comp


def getuid() -&gt; int:
    &#34;&#34;&#34;
    Returns the UID of the `Computer`&#39;s current user
    Returns:
        int: UID of the `Computers`&#39;s current user (from most recent session)
    &#34;&#34;&#34;
    return computer.sys_getuid()


def getgid() -&gt; int:
    &#34;&#34;&#34;
    Returns the (primary) GID of the `Computer`&#39;s current user
    Returns:
        int: (primary) GID of the `Computers`&#39;s current user (from most recent session)
    &#34;&#34;&#34;
    return computer.sys_getgid()


def getcwd() -&gt; FSBaseObject:
    &#34;&#34;&#34;
    Get current directory in the file system

    Returns:
        FSBaseObjectSB: The  user&#39;s current directory
    &#34;&#34;&#34;
    return computer.sys_getcwd()


def setuid(uid: int) -&gt; Result:
    &#34;&#34;&#34;
    Change current `Session`&#39;s effective UID to the given `UID`

    Notes:
        setuid() followed the current rules:
            * If the &#34;caller&#34; uid is root, change the uid to whatever is given
            * If the &#34;caller&#34; isn&#39;t root, BUT the setuid bit (not implement yet) is set, the UID can be set to the owner of the file
            * If the &#34;caller&#34; isn&#39;t root, and the setuid bit ISN&#39;T set, deny all changes

    Args:
        uid (int): The new UID to change to

    Returns:
        Result: A `Result` object with the success flag set accordingly
    &#34;&#34;&#34;
    return computer.sys_setuid(uid)


def gethostname() -&gt; str:
    &#34;&#34;&#34;
    Gets the current system hostname (from internal var, not /etc/hostname)

    Returns:
        str: &#34;localhost&#34; if the hostname isn&#39;t set, otherwise, the current `Computer`&#39;s hostname
    &#34;&#34;&#34;
    return computer.sys_gethostname()


def sethostname(hostname: str) -&gt; Result:
    &#34;&#34;&#34;
    An easy function to update the hostname (also updates /etc/hostname)
    Args:
        hostname (str): The `Computer`&#39;s new hostname

    Returns:
        Result: A `Result` instance with the `success` flag set accordingly.
    &#34;&#34;&#34;
    return computer.sys_sethostname(hostname)


def read(filepath: str) -&gt; Result:
    &#34;&#34;&#34;
    Try to read the content of the given `filepath`. Checks permissions

    Args:
        filepath (str): The path of the file to read

    Returns:
        Result: A `Result` object with the success flag set accordingly and the data flag containing the files
        if read was successful
    &#34;&#34;&#34;
    return computer.sys_read(filepath)


def write(fd: Union[str, Socket], data: Union[str, dict]) -&gt; Result:
    &#34;&#34;&#34;
    Try to write to a given file descriptor. If `fd` is a file path, this function will try to write to a file
    (permission safe), however, if the fd is a `Socket`, this function will try to send the given `data` to the
    respective `Socket`&#39;s connected service (if connected).

    Args:
        fd (str or :obj:`Socket`): The filepath of the file or Socket to write to
        data (str or dict): The data to write to the file (if fd == str) or data to send to the socket (if fd == Socket)

    Returns:
        Result: A `Result` object with the success flag set accordingly
    &#34;&#34;&#34;
    return computer.sys_write(fd, data)


def access(pathname: str, mode: int) -&gt; Result:
    &#34;&#34;&#34;
    Check if the current effective UID has a given permission to the given `File`/`Directory`
    Possible modes are:
        * F_OK: File exists
        * R_OK: Read permission
        * W_OK: Write permissions
        * X_OK: Execute permission

    Args:
        pathname (str): The file path of the given `File`/`Directory` to check
        mode (int): Bitwise flags of the permissions to check

    Returns:
        Result: A `Result` object with the success flag set accordingly
    &#34;&#34;&#34;
    return computer.sys_access(pathname, mode)


def chown(pathname: str, owner: int, group: int) -&gt; Result:
    &#34;&#34;&#34;
    Change the owner of the given `pathname` (if allowed)

    Notes:
        Only the owner or root is allowed to change the owner of a `File`/`Directory`

    Args:
        pathname (str): The file path of the `File`/`Directory` to change the owner of
        owner (int): The UID of the new owner
        group (int): The GID of the new owner

    Returns:
        Result: A `Result` object with the success flag set accordingly
    &#34;&#34;&#34;
    return computer.sys_chown(pathname, owner, group)


def chdir(pathname: str) -&gt; Result:
    &#34;&#34;&#34;
    Change the `current_dir` of the current `Session`

    Args:
        pathname (str): The file path of the directory to `cd` into

    Returns:
        Result: A `Result` object with the success flag set accordingly
    &#34;&#34;&#34;
    return computer.sys_chdir(pathname)


# TODO: Replace the `get_` functions with something related to pwd.h

def add_user(username: str, password: str, uid: Optional[int] = None, plaintext: bool = True) -&gt; Result:
    &#34;&#34;&#34;
    Add a new user to the system (permission safe).
    This function also generates the UID for the new user (unless manually specified)

    Args:
        username (str): The username for the new user
        password (str): The plaintext password for the new user
        uid (int, optional): The UID of the new user
                    plaintext (bool): If the given `new_password` is plain text or an MD5 hash

    Returns:
        Result: A `Result` instance with the `success` flag set accordingly. The `data` flag contains the new users UID if successful.
    &#34;&#34;&#34;
    if computer.sys_getuid() != 0:
        return Result(success=False, message=ResultMessages.NOT_ALLOWED)
    return computer.add_user(username, password, uid, plaintext)


def get_user(uid: Optional[int] = None, username: Optional[str] = None) -&gt; Result:
    &#34;&#34;&#34;
    Find a user in the database by UID or username
    Args:
        uid (int, optional): The UID of the user to find
        username (str, optional): The username of the user to find

    Returns:
        Result: A `Result` with the `success` flag set accordingly. The `data` flag contains the user dict if found
    &#34;&#34;&#34;
    return computer.get_user(uid, username)


def get_all_users() -&gt; Result:
    &#34;&#34;&#34;
    Get all users that exist in the given system in the given format:

    Returns:
        Result: A `Result` with the `data` flag containing the array of `User`s
    &#34;&#34;&#34;
    return computer.get_all_users()


def add_group(name: str, gid: Optional[int] = None) -&gt; Result:
    &#34;&#34;&#34;
    Add a new group to the system (permission safe).
    This function also generates the GID for the new group (unless manually specified)

    Args:
        name (str): The name for the new group
        gid (int, optional): The GID of the new user

    Returns:
        Result: A `Result` instance with the `success` flag set accordingly. The `data` flag contains the GID if successful.
    &#34;&#34;&#34;
    if computer.sys_getuid() != 0:
        return Result(success=False, message=ResultMessages.NOT_ALLOWED)
    return computer.add_group(name, gid)


def get_group(gid: Optional[int] = None, name: Optional[str] = None) -&gt; Result:
    &#34;&#34;&#34;
    Find a group in the database by GID or name or both
    Args:
        gid (int, optional): The GID of the group to find
        name (str, optional): The name of the group to find

    Returns:
        Result: A `Result` with the `success` flag set accordingly. The `data` flag contains the group dict if found
    &#34;&#34;&#34;
    return computer.get_group(gid, name)


def add_user_to_group(uid: int, gid: int,
                      membership_type: Literal[&#34;primary&#34;, &#34;secondary&#34;] = &#34;secondary&#34;) -&gt; Result:
    &#34;&#34;&#34;
    Add a user to a group (by uid and gid) (permission safe)

    Args:
        uid (int): The UID of the user
        gid (int): The GID of the group to add the user to
        membership_type (str): The type of group relationship (primary, secondary)

    Returns:
        Result: A `Result` object with the `success` flag set accordingly
    &#34;&#34;&#34;
    if computer.sys_getuid() != 0:
        return Result(success=False, message=ResultMessages.NOT_ALLOWED)
    return computer.add_user_to_group(uid, gid, membership_type)


def get_user_primary_group(uid: int) -&gt; Result:
    &#34;&#34;&#34;
    Get the `Group` GID&#39;s that is the `User`s primary `Group` (by UID)

    Args:
        uid (int): The UID of the user to lookup

    Returns:
        Result: A `Result` with the `data` flag containing a list of GIDs
    &#34;&#34;&#34;
    return computer.get_user_primary_group(uid)


def get_user_groups(uid: int) -&gt; Result:
    &#34;&#34;&#34;
    Get the list of `Group` GID&#39;s that the `User` belongs to (by UID)

    Args:
        uid (int): The UID of the user to lookup

    Returns:
        Result: A `Result` with the `data` flag containing a list of GIDs
    &#34;&#34;&#34;
    return computer.get_user_groups(uid)


# NOTE: Temporary until I get a realistic version working
def get_sessions() -&gt; Result:
    &#34;&#34;&#34;
    Get all the current open sessions in the computer

    Returns:
        Result: A `Result` object containing a list of all the `Computer`s open session
    &#34;&#34;&#34;
    return Result(success=True, data=computer.sessions)


def reboot(mode: int) -&gt; Result:
    &#34;&#34;&#34;
    Simulate a computer reboot. Clear all sessions and re-initialize the machine

    Args:
        mode (int: Bitwise flags of the operation to take

    Returns:
        Result: A `Result` object with the success flag set accordingly
    &#34;&#34;&#34;
    return computer.sys_reboot(mode)


def rmdir(pathname: str) -&gt; Result:
    &#34;&#34;&#34;
    Remove an empty directory

    Args:
        pathname (str): The file path of the empty `Directory` to remove

    Returns:
        Result: A `Result` object with the success flag set accordingly
    &#34;&#34;&#34;
    return computer.sys_rmdir(pathname)


def save(file: Optional[str]) -&gt; bool:
    &#34;&#34;&#34;
    Serialize and dump the current `Computer` (and everything that&#39;s connected to it (`StandardFS`, `File`s, etc)) to a file
    Args:
        output_file (str, optional): The file to dump the contents to

    Returns:
        bool: `True` if the dump/save was successful, otherwise `False`
    &#34;&#34;&#34;
    return computer.save(file)


def execv(pathname: str, argv: list) -&gt; Result:
    &#34;&#34;&#34;
    Execute a file

    Args:
        pathname (str): The path name of the binary to execute
        argv (list): A list of arguments to pass to the binary

    Returns:
        Result: A `Result` arguments containing the output from the binary
    &#34;&#34;&#34;
    return computer.sys_execv(pathname, argv)


def execvp(command: str, argv: list) -&gt; Result:
    &#34;&#34;&#34;
    Execute a command using the PATH rather than the full binary path. Does exactly what the system shell does.

    Args:
        command (str): The command to run
        argv (list): A list of arguments to pass to the binary

    Returns:
        Result: A `Result` arguments containing the output from the binary
    &#34;&#34;&#34;
    return computer.sys_execvp(command, argv)


def new_session(uid: int) -&gt; None:
    &#34;&#34;&#34;
    Temporary function: Open a new session in the current `Computer`

    Args:
        uid (int): The real UID of the user in the new `Session`

    Returns:
        None
    &#34;&#34;&#34;
    # TODO: Make this more realistic since I have no clue how it works in real life
    current_session: Session = computer.sessions[-1]
    # Create a new session
    new_session = Session(uid, current_session.current_dir, current_session.id + 1)
    computer.sessions.append(new_session)
    computer.run_current_user_shellrc()


def unlink(pathname: str) -&gt; Result:
    &#34;&#34;&#34;
    Removes a link to a file. If there are no links left, the file is removed.

    Args:
        pathname (str): The file path of the `File` to unlink

    Returns:
        Result: A `Result` arguments containing the output from the binary

    &#34;&#34;&#34;
    return computer.sys_unlink(pathname)</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="blackhat.lib.unistd.access"><code class="name flex">
<span>def <span class="ident">access</span></span>(<span>pathname: str, mode: int) ‑> <a title="blackhat.helpers.Result" href="../helpers.html#blackhat.helpers.Result">Result</a></span>
</code></dt>
<dd>
<div class="desc"><p>Check if the current effective UID has a given permission to the given <code>File</code>/<code>Directory</code>
Possible modes are:
* F_OK: File exists
* R_OK: Read permission
* W_OK: Write permissions
* X_OK: Execute permission</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pathname</code></strong> :&ensp;<code>str</code></dt>
<dd>The file path of the given <code>File</code>/<code>Directory</code> to check</dd>
<dt><strong><code>mode</code></strong> :&ensp;<code>int</code></dt>
<dd>Bitwise flags of the permissions to check</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Result</code></dt>
<dd>A <code>Result</code> object with the success flag set accordingly</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def access(pathname: str, mode: int) -&gt; Result:
    &#34;&#34;&#34;
    Check if the current effective UID has a given permission to the given `File`/`Directory`
    Possible modes are:
        * F_OK: File exists
        * R_OK: Read permission
        * W_OK: Write permissions
        * X_OK: Execute permission

    Args:
        pathname (str): The file path of the given `File`/`Directory` to check
        mode (int): Bitwise flags of the permissions to check

    Returns:
        Result: A `Result` object with the success flag set accordingly
    &#34;&#34;&#34;
    return computer.sys_access(pathname, mode)</code></pre>
</details>
</dd>
<dt id="blackhat.lib.unistd.add_group"><code class="name flex">
<span>def <span class="ident">add_group</span></span>(<span>name: str, gid: Optional[int] = None) ‑> <a title="blackhat.helpers.Result" href="../helpers.html#blackhat.helpers.Result">Result</a></span>
</code></dt>
<dd>
<div class="desc"><p>Add a new group to the system (permission safe).
This function also generates the GID for the new group (unless manually specified)</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>name</code></strong> :&ensp;<code>str</code></dt>
<dd>The name for the new group</dd>
<dt><strong><code>gid</code></strong> :&ensp;<code>int</code>, optional</dt>
<dd>The GID of the new user</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Result</code></dt>
<dd>A <code>Result</code> instance with the <code>success</code> flag set accordingly. The <code>data</code> flag contains the GID if successful.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_group(name: str, gid: Optional[int] = None) -&gt; Result:
    &#34;&#34;&#34;
    Add a new group to the system (permission safe).
    This function also generates the GID for the new group (unless manually specified)

    Args:
        name (str): The name for the new group
        gid (int, optional): The GID of the new user

    Returns:
        Result: A `Result` instance with the `success` flag set accordingly. The `data` flag contains the GID if successful.
    &#34;&#34;&#34;
    if computer.sys_getuid() != 0:
        return Result(success=False, message=ResultMessages.NOT_ALLOWED)
    return computer.add_group(name, gid)</code></pre>
</details>
</dd>
<dt id="blackhat.lib.unistd.add_user"><code class="name flex">
<span>def <span class="ident">add_user</span></span>(<span>username: str, password: str, uid: Optional[int] = None, plaintext: bool = True) ‑> <a title="blackhat.helpers.Result" href="../helpers.html#blackhat.helpers.Result">Result</a></span>
</code></dt>
<dd>
<div class="desc"><p>Add a new user to the system (permission safe).
This function also generates the UID for the new user (unless manually specified)</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>username</code></strong> :&ensp;<code>str</code></dt>
<dd>The username for the new user</dd>
<dt><strong><code>password</code></strong> :&ensp;<code>str</code></dt>
<dd>The plaintext password for the new user</dd>
<dt><strong><code>uid</code></strong> :&ensp;<code>int</code>, optional</dt>
<dd>The UID of the new user
plaintext (bool): If the given <code>new_password</code> is plain text or an MD5 hash</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Result</code></dt>
<dd>A <code>Result</code> instance with the <code>success</code> flag set accordingly. The <code>data</code> flag contains the new users UID if successful.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_user(username: str, password: str, uid: Optional[int] = None, plaintext: bool = True) -&gt; Result:
    &#34;&#34;&#34;
    Add a new user to the system (permission safe).
    This function also generates the UID for the new user (unless manually specified)

    Args:
        username (str): The username for the new user
        password (str): The plaintext password for the new user
        uid (int, optional): The UID of the new user
                    plaintext (bool): If the given `new_password` is plain text or an MD5 hash

    Returns:
        Result: A `Result` instance with the `success` flag set accordingly. The `data` flag contains the new users UID if successful.
    &#34;&#34;&#34;
    if computer.sys_getuid() != 0:
        return Result(success=False, message=ResultMessages.NOT_ALLOWED)
    return computer.add_user(username, password, uid, plaintext)</code></pre>
</details>
</dd>
<dt id="blackhat.lib.unistd.add_user_to_group"><code class="name flex">
<span>def <span class="ident">add_user_to_group</span></span>(<span>uid: int, gid: int, membership_type: Literal['primary', 'secondary'] = 'secondary') ‑> <a title="blackhat.helpers.Result" href="../helpers.html#blackhat.helpers.Result">Result</a></span>
</code></dt>
<dd>
<div class="desc"><p>Add a user to a group (by uid and gid) (permission safe)</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>uid</code></strong> :&ensp;<code>int</code></dt>
<dd>The UID of the user</dd>
<dt><strong><code>gid</code></strong> :&ensp;<code>int</code></dt>
<dd>The GID of the group to add the user to</dd>
<dt><strong><code>membership_type</code></strong> :&ensp;<code>str</code></dt>
<dd>The type of group relationship (primary, secondary)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Result</code></dt>
<dd>A <code>Result</code> object with the <code>success</code> flag set accordingly</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def add_user_to_group(uid: int, gid: int,
                      membership_type: Literal[&#34;primary&#34;, &#34;secondary&#34;] = &#34;secondary&#34;) -&gt; Result:
    &#34;&#34;&#34;
    Add a user to a group (by uid and gid) (permission safe)

    Args:
        uid (int): The UID of the user
        gid (int): The GID of the group to add the user to
        membership_type (str): The type of group relationship (primary, secondary)

    Returns:
        Result: A `Result` object with the `success` flag set accordingly
    &#34;&#34;&#34;
    if computer.sys_getuid() != 0:
        return Result(success=False, message=ResultMessages.NOT_ALLOWED)
    return computer.add_user_to_group(uid, gid, membership_type)</code></pre>
</details>
</dd>
<dt id="blackhat.lib.unistd.chdir"><code class="name flex">
<span>def <span class="ident">chdir</span></span>(<span>pathname: str) ‑> <a title="blackhat.helpers.Result" href="../helpers.html#blackhat.helpers.Result">Result</a></span>
</code></dt>
<dd>
<div class="desc"><p>Change the <code>current_dir</code> of the current <code>Session</code></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pathname</code></strong> :&ensp;<code>str</code></dt>
<dd>The file path of the directory to <code>cd</code> into</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Result</code></dt>
<dd>A <code>Result</code> object with the success flag set accordingly</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def chdir(pathname: str) -&gt; Result:
    &#34;&#34;&#34;
    Change the `current_dir` of the current `Session`

    Args:
        pathname (str): The file path of the directory to `cd` into

    Returns:
        Result: A `Result` object with the success flag set accordingly
    &#34;&#34;&#34;
    return computer.sys_chdir(pathname)</code></pre>
</details>
</dd>
<dt id="blackhat.lib.unistd.chown"><code class="name flex">
<span>def <span class="ident">chown</span></span>(<span>pathname: str, owner: int, group: int) ‑> <a title="blackhat.helpers.Result" href="../helpers.html#blackhat.helpers.Result">Result</a></span>
</code></dt>
<dd>
<div class="desc"><p>Change the owner of the given <code>pathname</code> (if allowed)</p>
<h2 id="notes">Notes</h2>
<p>Only the owner or root is allowed to change the owner of a <code>File</code>/<code>Directory</code></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pathname</code></strong> :&ensp;<code>str</code></dt>
<dd>The file path of the <code>File</code>/<code>Directory</code> to change the owner of</dd>
<dt><strong><code>owner</code></strong> :&ensp;<code>int</code></dt>
<dd>The UID of the new owner</dd>
<dt><strong><code>group</code></strong> :&ensp;<code>int</code></dt>
<dd>The GID of the new owner</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Result</code></dt>
<dd>A <code>Result</code> object with the success flag set accordingly</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def chown(pathname: str, owner: int, group: int) -&gt; Result:
    &#34;&#34;&#34;
    Change the owner of the given `pathname` (if allowed)

    Notes:
        Only the owner or root is allowed to change the owner of a `File`/`Directory`

    Args:
        pathname (str): The file path of the `File`/`Directory` to change the owner of
        owner (int): The UID of the new owner
        group (int): The GID of the new owner

    Returns:
        Result: A `Result` object with the success flag set accordingly
    &#34;&#34;&#34;
    return computer.sys_chown(pathname, owner, group)</code></pre>
</details>
</dd>
<dt id="blackhat.lib.unistd.execv"><code class="name flex">
<span>def <span class="ident">execv</span></span>(<span>pathname: str, argv: list) ‑> <a title="blackhat.helpers.Result" href="../helpers.html#blackhat.helpers.Result">Result</a></span>
</code></dt>
<dd>
<div class="desc"><p>Execute a file</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pathname</code></strong> :&ensp;<code>str</code></dt>
<dd>The path name of the binary to execute</dd>
<dt><strong><code>argv</code></strong> :&ensp;<code>list</code></dt>
<dd>A list of arguments to pass to the binary</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Result</code></dt>
<dd>A <code>Result</code> arguments containing the output from the binary</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def execv(pathname: str, argv: list) -&gt; Result:
    &#34;&#34;&#34;
    Execute a file

    Args:
        pathname (str): The path name of the binary to execute
        argv (list): A list of arguments to pass to the binary

    Returns:
        Result: A `Result` arguments containing the output from the binary
    &#34;&#34;&#34;
    return computer.sys_execv(pathname, argv)</code></pre>
</details>
</dd>
<dt id="blackhat.lib.unistd.execvp"><code class="name flex">
<span>def <span class="ident">execvp</span></span>(<span>command: str, argv: list) ‑> <a title="blackhat.helpers.Result" href="../helpers.html#blackhat.helpers.Result">Result</a></span>
</code></dt>
<dd>
<div class="desc"><p>Execute a command using the PATH rather than the full binary path. Does exactly what the system shell does.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>command</code></strong> :&ensp;<code>str</code></dt>
<dd>The command to run</dd>
<dt><strong><code>argv</code></strong> :&ensp;<code>list</code></dt>
<dd>A list of arguments to pass to the binary</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Result</code></dt>
<dd>A <code>Result</code> arguments containing the output from the binary</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def execvp(command: str, argv: list) -&gt; Result:
    &#34;&#34;&#34;
    Execute a command using the PATH rather than the full binary path. Does exactly what the system shell does.

    Args:
        command (str): The command to run
        argv (list): A list of arguments to pass to the binary

    Returns:
        Result: A `Result` arguments containing the output from the binary
    &#34;&#34;&#34;
    return computer.sys_execvp(command, argv)</code></pre>
</details>
</dd>
<dt id="blackhat.lib.unistd.get_all_users"><code class="name flex">
<span>def <span class="ident">get_all_users</span></span>(<span>) ‑> <a title="blackhat.helpers.Result" href="../helpers.html#blackhat.helpers.Result">Result</a></span>
</code></dt>
<dd>
<div class="desc"><p>Get all users that exist in the given system in the given format:</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Result</code></dt>
<dd>A <code>Result</code> with the <code>data</code> flag containing the array of <code>User</code>s</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_all_users() -&gt; Result:
    &#34;&#34;&#34;
    Get all users that exist in the given system in the given format:

    Returns:
        Result: A `Result` with the `data` flag containing the array of `User`s
    &#34;&#34;&#34;
    return computer.get_all_users()</code></pre>
</details>
</dd>
<dt id="blackhat.lib.unistd.get_group"><code class="name flex">
<span>def <span class="ident">get_group</span></span>(<span>gid: Optional[int] = None, name: Optional[str] = None) ‑> <a title="blackhat.helpers.Result" href="../helpers.html#blackhat.helpers.Result">Result</a></span>
</code></dt>
<dd>
<div class="desc"><p>Find a group in the database by GID or name or both</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>gid</code></strong> :&ensp;<code>int</code>, optional</dt>
<dd>The GID of the group to find</dd>
<dt><strong><code>name</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The name of the group to find</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Result</code></dt>
<dd>A <code>Result</code> with the <code>success</code> flag set accordingly. The <code>data</code> flag contains the group dict if found</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_group(gid: Optional[int] = None, name: Optional[str] = None) -&gt; Result:
    &#34;&#34;&#34;
    Find a group in the database by GID or name or both
    Args:
        gid (int, optional): The GID of the group to find
        name (str, optional): The name of the group to find

    Returns:
        Result: A `Result` with the `success` flag set accordingly. The `data` flag contains the group dict if found
    &#34;&#34;&#34;
    return computer.get_group(gid, name)</code></pre>
</details>
</dd>
<dt id="blackhat.lib.unistd.get_sessions"><code class="name flex">
<span>def <span class="ident">get_sessions</span></span>(<span>) ‑> <a title="blackhat.helpers.Result" href="../helpers.html#blackhat.helpers.Result">Result</a></span>
</code></dt>
<dd>
<div class="desc"><p>Get all the current open sessions in the computer</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Result</code></dt>
<dd>A <code>Result</code> object containing a list of all the <code>Computer</code>s open session</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_sessions() -&gt; Result:
    &#34;&#34;&#34;
    Get all the current open sessions in the computer

    Returns:
        Result: A `Result` object containing a list of all the `Computer`s open session
    &#34;&#34;&#34;
    return Result(success=True, data=computer.sessions)</code></pre>
</details>
</dd>
<dt id="blackhat.lib.unistd.get_user"><code class="name flex">
<span>def <span class="ident">get_user</span></span>(<span>uid: Optional[int] = None, username: Optional[str] = None) ‑> <a title="blackhat.helpers.Result" href="../helpers.html#blackhat.helpers.Result">Result</a></span>
</code></dt>
<dd>
<div class="desc"><p>Find a user in the database by UID or username</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>uid</code></strong> :&ensp;<code>int</code>, optional</dt>
<dd>The UID of the user to find</dd>
<dt><strong><code>username</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The username of the user to find</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Result</code></dt>
<dd>A <code>Result</code> with the <code>success</code> flag set accordingly. The <code>data</code> flag contains the user dict if found</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_user(uid: Optional[int] = None, username: Optional[str] = None) -&gt; Result:
    &#34;&#34;&#34;
    Find a user in the database by UID or username
    Args:
        uid (int, optional): The UID of the user to find
        username (str, optional): The username of the user to find

    Returns:
        Result: A `Result` with the `success` flag set accordingly. The `data` flag contains the user dict if found
    &#34;&#34;&#34;
    return computer.get_user(uid, username)</code></pre>
</details>
</dd>
<dt id="blackhat.lib.unistd.get_user_groups"><code class="name flex">
<span>def <span class="ident">get_user_groups</span></span>(<span>uid: int) ‑> <a title="blackhat.helpers.Result" href="../helpers.html#blackhat.helpers.Result">Result</a></span>
</code></dt>
<dd>
<div class="desc"><p>Get the list of <code>Group</code> GID's that the <code>User</code> belongs to (by UID)</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>uid</code></strong> :&ensp;<code>int</code></dt>
<dd>The UID of the user to lookup</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Result</code></dt>
<dd>A <code>Result</code> with the <code>data</code> flag containing a list of GIDs</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_user_groups(uid: int) -&gt; Result:
    &#34;&#34;&#34;
    Get the list of `Group` GID&#39;s that the `User` belongs to (by UID)

    Args:
        uid (int): The UID of the user to lookup

    Returns:
        Result: A `Result` with the `data` flag containing a list of GIDs
    &#34;&#34;&#34;
    return computer.get_user_groups(uid)</code></pre>
</details>
</dd>
<dt id="blackhat.lib.unistd.get_user_primary_group"><code class="name flex">
<span>def <span class="ident">get_user_primary_group</span></span>(<span>uid: int) ‑> <a title="blackhat.helpers.Result" href="../helpers.html#blackhat.helpers.Result">Result</a></span>
</code></dt>
<dd>
<div class="desc"><p>Get the <code>Group</code> GID's that is the <code>User</code>s primary <code>Group</code> (by UID)</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>uid</code></strong> :&ensp;<code>int</code></dt>
<dd>The UID of the user to lookup</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Result</code></dt>
<dd>A <code>Result</code> with the <code>data</code> flag containing a list of GIDs</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_user_primary_group(uid: int) -&gt; Result:
    &#34;&#34;&#34;
    Get the `Group` GID&#39;s that is the `User`s primary `Group` (by UID)

    Args:
        uid (int): The UID of the user to lookup

    Returns:
        Result: A `Result` with the `data` flag containing a list of GIDs
    &#34;&#34;&#34;
    return computer.get_user_primary_group(uid)</code></pre>
</details>
</dd>
<dt id="blackhat.lib.unistd.getcwd"><code class="name flex">
<span>def <span class="ident">getcwd</span></span>(<span>) ‑> <a title="blackhat.fs.FSBaseObject" href="../fs.html#blackhat.fs.FSBaseObject">FSBaseObject</a></span>
</code></dt>
<dd>
<div class="desc"><p>Get current directory in the file system</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>FSBaseObjectSB</code></dt>
<dd>The
user's current directory</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def getcwd() -&gt; FSBaseObject:
    &#34;&#34;&#34;
    Get current directory in the file system

    Returns:
        FSBaseObjectSB: The  user&#39;s current directory
    &#34;&#34;&#34;
    return computer.sys_getcwd()</code></pre>
</details>
</dd>
<dt id="blackhat.lib.unistd.getgid"><code class="name flex">
<span>def <span class="ident">getgid</span></span>(<span>) ‑> int</span>
</code></dt>
<dd>
<div class="desc"><p>Returns the (primary) GID of the <code>Computer</code>'s current user</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>int</code></dt>
<dd>(primary) GID of the <code>Computers</code>'s current user (from most recent session)</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def getgid() -&gt; int:
    &#34;&#34;&#34;
    Returns the (primary) GID of the `Computer`&#39;s current user
    Returns:
        int: (primary) GID of the `Computers`&#39;s current user (from most recent session)
    &#34;&#34;&#34;
    return computer.sys_getgid()</code></pre>
</details>
</dd>
<dt id="blackhat.lib.unistd.gethostname"><code class="name flex">
<span>def <span class="ident">gethostname</span></span>(<span>) ‑> str</span>
</code></dt>
<dd>
<div class="desc"><p>Gets the current system hostname (from internal var, not /etc/hostname)</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>str</code></dt>
<dd>"localhost" if the hostname isn't set, otherwise, the current <code>Computer</code>'s hostname</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def gethostname() -&gt; str:
    &#34;&#34;&#34;
    Gets the current system hostname (from internal var, not /etc/hostname)

    Returns:
        str: &#34;localhost&#34; if the hostname isn&#39;t set, otherwise, the current `Computer`&#39;s hostname
    &#34;&#34;&#34;
    return computer.sys_gethostname()</code></pre>
</details>
</dd>
<dt id="blackhat.lib.unistd.getuid"><code class="name flex">
<span>def <span class="ident">getuid</span></span>(<span>) ‑> int</span>
</code></dt>
<dd>
<div class="desc"><p>Returns the UID of the <code>Computer</code>'s current user</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>int</code></dt>
<dd>UID of the <code>Computers</code>'s current user (from most recent session)</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def getuid() -&gt; int:
    &#34;&#34;&#34;
    Returns the UID of the `Computer`&#39;s current user
    Returns:
        int: UID of the `Computers`&#39;s current user (from most recent session)
    &#34;&#34;&#34;
    return computer.sys_getuid()</code></pre>
</details>
</dd>
<dt id="blackhat.lib.unistd.new_session"><code class="name flex">
<span>def <span class="ident">new_session</span></span>(<span>uid: int) ‑> None</span>
</code></dt>
<dd>
<div class="desc"><p>Temporary function: Open a new session in the current <code>Computer</code></p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>uid</code></strong> :&ensp;<code>int</code></dt>
<dd>The real UID of the user in the new <code>Session</code></dd>
</dl>
<h2 id="returns">Returns</h2>
<p>None</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def new_session(uid: int) -&gt; None:
    &#34;&#34;&#34;
    Temporary function: Open a new session in the current `Computer`

    Args:
        uid (int): The real UID of the user in the new `Session`

    Returns:
        None
    &#34;&#34;&#34;
    # TODO: Make this more realistic since I have no clue how it works in real life
    current_session: Session = computer.sessions[-1]
    # Create a new session
    new_session = Session(uid, current_session.current_dir, current_session.id + 1)
    computer.sessions.append(new_session)
    computer.run_current_user_shellrc()</code></pre>
</details>
</dd>
<dt id="blackhat.lib.unistd.read"><code class="name flex">
<span>def <span class="ident">read</span></span>(<span>filepath: str) ‑> <a title="blackhat.helpers.Result" href="../helpers.html#blackhat.helpers.Result">Result</a></span>
</code></dt>
<dd>
<div class="desc"><p>Try to read the content of the given <code>filepath</code>. Checks permissions</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>filepath</code></strong> :&ensp;<code>str</code></dt>
<dd>The path of the file to read</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Result</code></dt>
<dd>A <code>Result</code> object with the success flag set accordingly and the data flag containing the files</dd>
</dl>
<p>if read was successful</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def read(filepath: str) -&gt; Result:
    &#34;&#34;&#34;
    Try to read the content of the given `filepath`. Checks permissions

    Args:
        filepath (str): The path of the file to read

    Returns:
        Result: A `Result` object with the success flag set accordingly and the data flag containing the files
        if read was successful
    &#34;&#34;&#34;
    return computer.sys_read(filepath)</code></pre>
</details>
</dd>
<dt id="blackhat.lib.unistd.reboot"><code class="name flex">
<span>def <span class="ident">reboot</span></span>(<span>mode: int) ‑> <a title="blackhat.helpers.Result" href="../helpers.html#blackhat.helpers.Result">Result</a></span>
</code></dt>
<dd>
<div class="desc"><p>Simulate a computer reboot. Clear all sessions and re-initialize the machine</p>
<h2 id="args">Args</h2>
<p>mode (int: Bitwise flags of the operation to take</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Result</code></dt>
<dd>A <code>Result</code> object with the success flag set accordingly</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def reboot(mode: int) -&gt; Result:
    &#34;&#34;&#34;
    Simulate a computer reboot. Clear all sessions and re-initialize the machine

    Args:
        mode (int: Bitwise flags of the operation to take

    Returns:
        Result: A `Result` object with the success flag set accordingly
    &#34;&#34;&#34;
    return computer.sys_reboot(mode)</code></pre>
</details>
</dd>
<dt id="blackhat.lib.unistd.rmdir"><code class="name flex">
<span>def <span class="ident">rmdir</span></span>(<span>pathname: str) ‑> <a title="blackhat.helpers.Result" href="../helpers.html#blackhat.helpers.Result">Result</a></span>
</code></dt>
<dd>
<div class="desc"><p>Remove an empty directory</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pathname</code></strong> :&ensp;<code>str</code></dt>
<dd>The file path of the empty <code>Directory</code> to remove</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Result</code></dt>
<dd>A <code>Result</code> object with the success flag set accordingly</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def rmdir(pathname: str) -&gt; Result:
    &#34;&#34;&#34;
    Remove an empty directory

    Args:
        pathname (str): The file path of the empty `Directory` to remove

    Returns:
        Result: A `Result` object with the success flag set accordingly
    &#34;&#34;&#34;
    return computer.sys_rmdir(pathname)</code></pre>
</details>
</dd>
<dt id="blackhat.lib.unistd.save"><code class="name flex">
<span>def <span class="ident">save</span></span>(<span>file: Optional[str]) ‑> bool</span>
</code></dt>
<dd>
<div class="desc"><p>Serialize and dump the current <code>Computer</code> (and everything that's connected to it (<code>StandardFS</code>, <code>File</code>s, etc)) to a file</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>output_file</code></strong> :&ensp;<code>str</code>, optional</dt>
<dd>The file to dump the contents to</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>bool</code></dt>
<dd><code>True</code> if the dump/save was successful, otherwise <code>False</code></dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def save(file: Optional[str]) -&gt; bool:
    &#34;&#34;&#34;
    Serialize and dump the current `Computer` (and everything that&#39;s connected to it (`StandardFS`, `File`s, etc)) to a file
    Args:
        output_file (str, optional): The file to dump the contents to

    Returns:
        bool: `True` if the dump/save was successful, otherwise `False`
    &#34;&#34;&#34;
    return computer.save(file)</code></pre>
</details>
</dd>
<dt id="blackhat.lib.unistd.sethostname"><code class="name flex">
<span>def <span class="ident">sethostname</span></span>(<span>hostname: str) ‑> <a title="blackhat.helpers.Result" href="../helpers.html#blackhat.helpers.Result">Result</a></span>
</code></dt>
<dd>
<div class="desc"><p>An easy function to update the hostname (also updates /etc/hostname)</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>hostname</code></strong> :&ensp;<code>str</code></dt>
<dd>The <code>Computer</code>'s new hostname</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Result</code></dt>
<dd>A <code>Result</code> instance with the <code>success</code> flag set accordingly.</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def sethostname(hostname: str) -&gt; Result:
    &#34;&#34;&#34;
    An easy function to update the hostname (also updates /etc/hostname)
    Args:
        hostname (str): The `Computer`&#39;s new hostname

    Returns:
        Result: A `Result` instance with the `success` flag set accordingly.
    &#34;&#34;&#34;
    return computer.sys_sethostname(hostname)</code></pre>
</details>
</dd>
<dt id="blackhat.lib.unistd.setuid"><code class="name flex">
<span>def <span class="ident">setuid</span></span>(<span>uid: int) ‑> <a title="blackhat.helpers.Result" href="../helpers.html#blackhat.helpers.Result">Result</a></span>
</code></dt>
<dd>
<div class="desc"><p>Change current <code>Session</code>'s effective UID to the given <code>UID</code></p>
<h2 id="notes">Notes</h2>
<p>setuid() followed the current rules:
* If the "caller" uid is root, change the uid to whatever is given
* If the "caller" isn't root, BUT the setuid bit (not implement yet) is set, the UID can be set to the owner of the file
* If the "caller" isn't root, and the setuid bit ISN'T set, deny all changes</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>uid</code></strong> :&ensp;<code>int</code></dt>
<dd>The new UID to change to</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Result</code></dt>
<dd>A <code>Result</code> object with the success flag set accordingly</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def setuid(uid: int) -&gt; Result:
    &#34;&#34;&#34;
    Change current `Session`&#39;s effective UID to the given `UID`

    Notes:
        setuid() followed the current rules:
            * If the &#34;caller&#34; uid is root, change the uid to whatever is given
            * If the &#34;caller&#34; isn&#39;t root, BUT the setuid bit (not implement yet) is set, the UID can be set to the owner of the file
            * If the &#34;caller&#34; isn&#39;t root, and the setuid bit ISN&#39;T set, deny all changes

    Args:
        uid (int): The new UID to change to

    Returns:
        Result: A `Result` object with the success flag set accordingly
    &#34;&#34;&#34;
    return computer.sys_setuid(uid)</code></pre>
</details>
</dd>
<dt id="blackhat.lib.unistd.unlink"><code class="name flex">
<span>def <span class="ident">unlink</span></span>(<span>pathname: str) ‑> <a title="blackhat.helpers.Result" href="../helpers.html#blackhat.helpers.Result">Result</a></span>
</code></dt>
<dd>
<div class="desc"><p>Removes a link to a file. If there are no links left, the file is removed.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>pathname</code></strong> :&ensp;<code>str</code></dt>
<dd>The file path of the <code>File</code> to unlink</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Result</code></dt>
<dd>A <code>Result</code> arguments containing the output from the binary</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def unlink(pathname: str) -&gt; Result:
    &#34;&#34;&#34;
    Removes a link to a file. If there are no links left, the file is removed.

    Args:
        pathname (str): The file path of the `File` to unlink

    Returns:
        Result: A `Result` arguments containing the output from the binary

    &#34;&#34;&#34;
    return computer.sys_unlink(pathname)</code></pre>
</details>
</dd>
<dt id="blackhat.lib.unistd.update"><code class="name flex">
<span>def <span class="ident">update</span></span>(<span>comp: Computer)</span>
</code></dt>
<dd>
<div class="desc"><p>Store a reference to the games current <code>Computer</code> object as a global variable so methods can reference it without
requiring it as an argument</p>
<h2 id="args">Args</h2>
<p>comp (:obj:<code>Computer</code>): The games current <code>Computer</code> object</p>
<h2 id="returns">Returns</h2>
<p>None</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def update(comp: &#34;Computer&#34;):
    &#34;&#34;&#34;
    Store a reference to the games current `Computer` object as a global variable so methods can reference it without
    requiring it as an argument
    
    Args:
        comp (:obj:`Computer`): The games current `Computer` object

    Returns:
        None
    &#34;&#34;&#34;
    global computer
    computer = comp</code></pre>
</details>
</dd>
<dt id="blackhat.lib.unistd.write"><code class="name flex">
<span>def <span class="ident">write</span></span>(<span>fd: Union[str, <a title="blackhat.lib.sys.socket.Socket" href="sys/socket.html#blackhat.lib.sys.socket.Socket">Socket</a>], data: Union[str, dict]) ‑> <a title="blackhat.helpers.Result" href="../helpers.html#blackhat.helpers.Result">Result</a></span>
</code></dt>
<dd>
<div class="desc"><p>Try to write to a given file descriptor. If <code>fd</code> is a file path, this function will try to write to a file
(permission safe), however, if the fd is a <code>Socket</code>, this function will try to send the given <code>data</code> to the
respective <code>Socket</code>'s connected service (if connected).</p>
<h2 id="args">Args</h2>
<dl>
<dt>fd (str or :obj:<code>Socket</code>): The filepath of the file or Socket to write to</dt>
<dt><strong><code>data</code></strong> :&ensp;<code>str</code> or <code>dict</code></dt>
<dd>The data to write to the file (if fd == str) or data to send to the socket (if fd == Socket)</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>Result</code></dt>
<dd>A <code>Result</code> object with the success flag set accordingly</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def write(fd: Union[str, Socket], data: Union[str, dict]) -&gt; Result:
    &#34;&#34;&#34;
    Try to write to a given file descriptor. If `fd` is a file path, this function will try to write to a file
    (permission safe), however, if the fd is a `Socket`, this function will try to send the given `data` to the
    respective `Socket`&#39;s connected service (if connected).

    Args:
        fd (str or :obj:`Socket`): The filepath of the file or Socket to write to
        data (str or dict): The data to write to the file (if fd == str) or data to send to the socket (if fd == Socket)

    Returns:
        Result: A `Result` object with the success flag set accordingly
    &#34;&#34;&#34;
    return computer.sys_write(fd, data)</code></pre>
</details>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3>Super-module</h3>
<ul>
<li><code><a title="blackhat.lib" href="index.html">blackhat.lib</a></code></li>
</ul>
</li>
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="">
<li><code><a title="blackhat.lib.unistd.access" href="#blackhat.lib.unistd.access">access</a></code></li>
<li><code><a title="blackhat.lib.unistd.add_group" href="#blackhat.lib.unistd.add_group">add_group</a></code></li>
<li><code><a title="blackhat.lib.unistd.add_user" href="#blackhat.lib.unistd.add_user">add_user</a></code></li>
<li><code><a title="blackhat.lib.unistd.add_user_to_group" href="#blackhat.lib.unistd.add_user_to_group">add_user_to_group</a></code></li>
<li><code><a title="blackhat.lib.unistd.chdir" href="#blackhat.lib.unistd.chdir">chdir</a></code></li>
<li><code><a title="blackhat.lib.unistd.chown" href="#blackhat.lib.unistd.chown">chown</a></code></li>
<li><code><a title="blackhat.lib.unistd.execv" href="#blackhat.lib.unistd.execv">execv</a></code></li>
<li><code><a title="blackhat.lib.unistd.execvp" href="#blackhat.lib.unistd.execvp">execvp</a></code></li>
<li><code><a title="blackhat.lib.unistd.get_all_users" href="#blackhat.lib.unistd.get_all_users">get_all_users</a></code></li>
<li><code><a title="blackhat.lib.unistd.get_group" href="#blackhat.lib.unistd.get_group">get_group</a></code></li>
<li><code><a title="blackhat.lib.unistd.get_sessions" href="#blackhat.lib.unistd.get_sessions">get_sessions</a></code></li>
<li><code><a title="blackhat.lib.unistd.get_user" href="#blackhat.lib.unistd.get_user">get_user</a></code></li>
<li><code><a title="blackhat.lib.unistd.get_user_groups" href="#blackhat.lib.unistd.get_user_groups">get_user_groups</a></code></li>
<li><code><a title="blackhat.lib.unistd.get_user_primary_group" href="#blackhat.lib.unistd.get_user_primary_group">get_user_primary_group</a></code></li>
<li><code><a title="blackhat.lib.unistd.getcwd" href="#blackhat.lib.unistd.getcwd">getcwd</a></code></li>
<li><code><a title="blackhat.lib.unistd.getgid" href="#blackhat.lib.unistd.getgid">getgid</a></code></li>
<li><code><a title="blackhat.lib.unistd.gethostname" href="#blackhat.lib.unistd.gethostname">gethostname</a></code></li>
<li><code><a title="blackhat.lib.unistd.getuid" href="#blackhat.lib.unistd.getuid">getuid</a></code></li>
<li><code><a title="blackhat.lib.unistd.new_session" href="#blackhat.lib.unistd.new_session">new_session</a></code></li>
<li><code><a title="blackhat.lib.unistd.read" href="#blackhat.lib.unistd.read">read</a></code></li>
<li><code><a title="blackhat.lib.unistd.reboot" href="#blackhat.lib.unistd.reboot">reboot</a></code></li>
<li><code><a title="blackhat.lib.unistd.rmdir" href="#blackhat.lib.unistd.rmdir">rmdir</a></code></li>
<li><code><a title="blackhat.lib.unistd.save" href="#blackhat.lib.unistd.save">save</a></code></li>
<li><code><a title="blackhat.lib.unistd.sethostname" href="#blackhat.lib.unistd.sethostname">sethostname</a></code></li>
<li><code><a title="blackhat.lib.unistd.setuid" href="#blackhat.lib.unistd.setuid">setuid</a></code></li>
<li><code><a title="blackhat.lib.unistd.unlink" href="#blackhat.lib.unistd.unlink">unlink</a></code></li>
<li><code><a title="blackhat.lib.unistd.update" href="#blackhat.lib.unistd.update">update</a></code></li>
<li><code><a title="blackhat.lib.unistd.write" href="#blackhat.lib.unistd.write">write</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html><style>body {
    background-color: #121212;
    color: white;
}

#sidebar {
    background-color: #242424;
}

#sidebar code {
    background-color: #282828 !important;
}


a {
    color: #8c00f7 !important;
}

.name {
    background-color: #1a1a1a !important;
}

code {
    background-color: #1a1a1a !important;
}

pre {
    background-color: #242424 !important;
    border-top: #242424 !important;
    border-bottom: #242424 !important;
    overflow-x: hidden !important;
}


h1:target, h2:target, h3:target, h4:target, h5:target, h6:target{
    background: #8c00f7
}

/* Modify color syntax highlighting */
.hljs {
    display: block;
    overflow-x: auto;
    padding: .5em;
    color: white !important;
    background: #f8f8f8
}

.hljs-comment,
.hljs-quote {
    color: #998;
    font-style: italic
}

.hljs-keyword,
.hljs-selector-tag,
.hljs-subst {
    color: dodgerblue !important;
    font-weight: 700
}

.hljs-literal,
.hljs-number,
.hljs-tag .hljs-attr,
.hljs-template-variable,
.hljs-variable {
    color: teal
}

.hljs-doctag,
.hljs-string {
    color: #d14
}

.hljs-section,
.hljs-selector-id,
.hljs-title {
    color: #900;
    font-weight: 700
}

.hljs-subst {
    font-weight: 400
}

.hljs-class .hljs-title,
.hljs-type {
    color: #458;
    font-weight: 700
}

.hljs-attribute,
.hljs-name,
.hljs-tag {
    color: navy;
    font-weight: 400
}

.hljs-link,
.hljs-regexp {
    color: #009926
}

.hljs-bullet,
.hljs-symbol {
    color: #990073
}

.hljs-built_in,
.hljs-builtin-name {
    color: #0086b3
}

.hljs-meta {
    color: #999;
    font-weight: 700
}

.hljs-deletion {
    background: #fdd
}

.hljs-addition {
    background: #dfd
}

.hljs-emphasis {
    font-style: italic
}

.hljs-strong {
    font-weight: 700
}

/* Custom scrollbar */
/* width */
::-webkit-scrollbar {
    width: 10px;
}

/* Track */
::-webkit-scrollbar-track {
    box-shadow: inset 0 0 2.5px grey;
    border-radius: 5px;
}

/* Handle */
::-webkit-scrollbar-thumb {
    background: gray;
    border-radius: 5px;
}

/* Handle on hover */
::-webkit-scrollbar-thumb:hover {
    background: #6b6b6b;
}

@media only screen and (max-width: 600px) {
    pre {
        overflow: scroll !important;
    }

    pre::-webkit-scrollbar {
        display: none !important;
    }
}</style>
